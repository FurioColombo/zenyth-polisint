{"ast":null,"code":"import _classCallCheck from \"/Users/eliapirrello/Documents/GitHub/zenyth/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/eliapirrello/Documents/GitHub/zenyth/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/eliapirrello/Documents/GitHub/zenyth/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _get from \"/Users/eliapirrello/Documents/GitHub/zenyth/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/Users/eliapirrello/Documents/GitHub/zenyth/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/Users/eliapirrello/Documents/GitHub/zenyth/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/eliapirrello/Documents/GitHub/zenyth/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport { Monophonic } from \"./Monophonic\";\nimport { MonoSynth } from \"./MonoSynth\";\nimport { Signal } from \"../signal/Signal\";\nimport { readOnly } from \"../core/util/Interface\";\nimport { LFO } from \"../source/oscillator/LFO\";\nimport { Gain } from \"../core/context/Gain\";\nimport { Multiply } from \"../signal/Multiply\";\nimport { deepMerge, omitFromObject, optionsFromArguments } from \"../core/util/Defaults\";\n/**\n * DuoSynth is a monophonic synth composed of two [[MonoSynths]] run in parallel with control over the\n * frequency ratio between the two voices and vibrato effect.\n * @example\n * const duoSynth = new Tone.DuoSynth().toDestination();\n * duoSynth.triggerAttackRelease(\"C4\", \"2n\");\n * @category Instrument\n */\nexport var DuoSynth = /*#__PURE__*/function (_Monophonic) {\n  _inherits(DuoSynth, _Monophonic);\n  var _super = _createSuper(DuoSynth);\n  function DuoSynth() {\n    var _this;\n    _classCallCheck(this, DuoSynth);\n    _this = _super.call(this, optionsFromArguments(DuoSynth.getDefaults(), arguments));\n    _this.name = \"DuoSynth\";\n    var options = optionsFromArguments(DuoSynth.getDefaults(), arguments);\n    _this.voice0 = new MonoSynth(Object.assign(options.voice0, {\n      context: _this.context,\n      onsilence: function onsilence() {\n        return _this.onsilence(_assertThisInitialized(_this));\n      }\n    }));\n    _this.voice1 = new MonoSynth(Object.assign(options.voice1, {\n      context: _this.context\n    }));\n    _this.harmonicity = new Multiply({\n      context: _this.context,\n      units: \"positive\",\n      value: options.harmonicity\n    });\n    _this._vibrato = new LFO({\n      frequency: options.vibratoRate,\n      context: _this.context,\n      min: -50,\n      max: 50\n    });\n    // start the vibrato immediately\n    _this._vibrato.start();\n    _this.vibratoRate = _this._vibrato.frequency;\n    _this._vibratoGain = new Gain({\n      context: _this.context,\n      units: \"normalRange\",\n      gain: options.vibratoAmount\n    });\n    _this.vibratoAmount = _this._vibratoGain.gain;\n    _this.frequency = new Signal({\n      context: _this.context,\n      units: \"frequency\",\n      value: 440\n    });\n    _this.detune = new Signal({\n      context: _this.context,\n      units: \"cents\",\n      value: options.detune\n    });\n    // control the two voices frequency\n    _this.frequency.connect(_this.voice0.frequency);\n    _this.frequency.chain(_this.harmonicity, _this.voice1.frequency);\n    _this._vibrato.connect(_this._vibratoGain);\n    _this._vibratoGain.fan(_this.voice0.detune, _this.voice1.detune);\n    _this.detune.fan(_this.voice0.detune, _this.voice1.detune);\n    _this.voice0.connect(_this.output);\n    _this.voice1.connect(_this.output);\n    readOnly(_assertThisInitialized(_this), [\"voice0\", \"voice1\", \"frequency\", \"vibratoAmount\", \"vibratoRate\"]);\n    return _this;\n  }\n  _createClass(DuoSynth, [{\n    key: \"getLevelAtTime\",\n    value: function getLevelAtTime(time) {\n      time = this.toSeconds(time);\n      return this.voice0.envelope.getValueAtTime(time) + this.voice1.envelope.getValueAtTime(time);\n    }\n  }, {\n    key: \"_triggerEnvelopeAttack\",\n    value:\n    /**\n     * Trigger the attack portion of the note\n     */\n    function _triggerEnvelopeAttack(time, velocity) {\n      // @ts-ignore\n      this.voice0._triggerEnvelopeAttack(time, velocity);\n      // @ts-ignore\n      this.voice1._triggerEnvelopeAttack(time, velocity);\n    }\n    /**\n     * Trigger the release portion of the note\n     */\n  }, {\n    key: \"_triggerEnvelopeRelease\",\n    value: function _triggerEnvelopeRelease(time) {\n      // @ts-ignore\n      this.voice0._triggerEnvelopeRelease(time);\n      // @ts-ignore\n      this.voice1._triggerEnvelopeRelease(time);\n      return this;\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      _get(_getPrototypeOf(DuoSynth.prototype), \"dispose\", this).call(this);\n      this.voice0.dispose();\n      this.voice1.dispose();\n      this.frequency.dispose();\n      this.detune.dispose();\n      this._vibrato.dispose();\n      this.vibratoRate.dispose();\n      this._vibratoGain.dispose();\n      this.harmonicity.dispose();\n      return this;\n    }\n  }], [{\n    key: \"getDefaults\",\n    value: function getDefaults() {\n      return deepMerge(Monophonic.getDefaults(), {\n        vibratoAmount: 0.5,\n        vibratoRate: 5,\n        harmonicity: 1.5,\n        voice0: deepMerge(omitFromObject(MonoSynth.getDefaults(), Object.keys(Monophonic.getDefaults())), {\n          filterEnvelope: {\n            attack: 0.01,\n            decay: 0.0,\n            sustain: 1,\n            release: 0.5\n          },\n          envelope: {\n            attack: 0.01,\n            decay: 0.0,\n            sustain: 1,\n            release: 0.5\n          }\n        }),\n        voice1: deepMerge(omitFromObject(MonoSynth.getDefaults(), Object.keys(Monophonic.getDefaults())), {\n          filterEnvelope: {\n            attack: 0.01,\n            decay: 0.0,\n            sustain: 1,\n            release: 0.5\n          },\n          envelope: {\n            attack: 0.01,\n            decay: 0.0,\n            sustain: 1,\n            release: 0.5\n          }\n        })\n      });\n    }\n  }]);\n  return DuoSynth;\n}(Monophonic);","map":{"version":3,"mappings":"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","names":["Monophonic","MonoSynth","Signal","readOnly","LFO","Gain","Multiply","deepMerge","omitFromObject","optionsFromArguments","DuoSynth","getDefaults","arguments","options","voice0","Object","assign","context","onsilence","voice1","harmonicity","units","value","_vibrato","frequency","vibratoRate","min","max","start","_vibratoGain","gain","vibratoAmount","detune","connect","chain","fan","output","time","toSeconds","envelope","getValueAtTime","velocity","_triggerEnvelopeAttack","_triggerEnvelopeRelease","dispose","keys","filterEnvelope","attack","decay","sustain","release"],"sourceRoot":"","sources":["../../../Tone/instrument/DuoSynth.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}