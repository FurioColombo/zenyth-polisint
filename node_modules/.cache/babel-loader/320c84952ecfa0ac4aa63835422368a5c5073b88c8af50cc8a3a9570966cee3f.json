{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nexport var createEvaluateSource = function createEvaluateSource(window) {\n  return function (source) {\n    return new Promise(function (resolve, reject) {\n      if (window === null) {\n        // Bug #182 Chrome and Edge do throw an instance of a SyntaxError instead of a DOMException.\n        reject(new SyntaxError());\n        return;\n      }\n      var head = window.document.head;\n      if (head === null) {\n        // Bug #182 Chrome and Edge do throw an instance of a SyntaxError instead of a DOMException.\n        reject(new SyntaxError());\n      } else {\n        var script = window.document.createElement('script');\n        // @todo Safari doesn't like URLs with a type of 'application/javascript; charset=utf-8'.\n        var blob = new Blob([source], {\n          type: 'application/javascript'\n        });\n        var url = URL.createObjectURL(blob);\n        var originalOnErrorHandler = window.onerror;\n        var removeErrorEventListenerAndRevokeUrl = function removeErrorEventListenerAndRevokeUrl() {\n          window.onerror = originalOnErrorHandler;\n          URL.revokeObjectURL(url);\n        };\n        window.onerror = function (message, src, lineno, colno, error) {\n          // @todo Edge thinks the source is the one of the html document.\n          if (src === url || src === window.location.href && lineno === 1 && colno === 1) {\n            removeErrorEventListenerAndRevokeUrl();\n            reject(error);\n            return false;\n          }\n          if (originalOnErrorHandler !== null) {\n            return originalOnErrorHandler(message, src, lineno, colno, error);\n          }\n        };\n        script.onerror = function () {\n          removeErrorEventListenerAndRevokeUrl();\n          // Bug #182 Chrome and Edge do throw an instance of a SyntaxError instead of a DOMException.\n          reject(new SyntaxError());\n        };\n        script.onload = function () {\n          removeErrorEventListenerAndRevokeUrl();\n          resolve();\n        };\n        script.src = url;\n        script.type = 'module';\n        head.appendChild(script);\n      }\n    });\n  };\n};","map":{"version":3,"mappings":";;;;;;;AAEA,OAAO,IAAMA,oBAAoB,GAA2B,SAA/CA,oBAAoB,CAA4BC,MAAM,EAAI;EACnE,OAAO,UAACC,MAAM;IAAA,OACV,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAI;MAC5B,IAAIJ,MAAM,KAAK,IAAI,EAAE;QACjB;QACAI,MAAM,CAAC,IAAIC,WAAW,EAAE,CAAC;QAEzB;;MAGJ,IAAMC,IAAI,GAAGN,MAAM,CAACO,QAAQ,CAACD,IAAI;MAEjC,IAAIA,IAAI,KAAK,IAAI,EAAE;QACf;QACAF,MAAM,CAAC,IAAIC,WAAW,EAAE,CAAC;OAC5B,MAAM;QACH,IAAMG,MAAM,GAAGR,MAAM,CAACO,QAAQ,CAACE,aAAa,CAAC,QAAQ,CAAC;QACtD;QACA,IAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACV,MAAM,CAAC,EAAE;UAAEW,IAAI,EAAE;QAAwB,CAAE,CAAC;QACnE,IAAMC,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC;QAErC,IAAMM,sBAAsB,GAAGhB,MAAM,CAACiB,OAAO;QAE7C,IAAMC,oCAAoC,GAAG,SAAvCA,oCAAoC,GAAQ;UAC9ClB,MAAM,CAACiB,OAAO,GAAGD,sBAAsB;UAEvCF,GAAG,CAACK,eAAe,CAACN,GAAG,CAAC;QAC5B,CAAC;QAEDb,MAAM,CAACiB,OAAO,GAAG,UAACG,OAAO,EAAEC,GAAG,EAAEC,MAAM,EAAEC,KAAK,EAAEC,KAAK,EAAI;UACpD;UACA,IAAIH,GAAG,KAAKR,GAAG,IAAKQ,GAAG,KAAKrB,MAAM,CAACyB,QAAQ,CAACC,IAAI,IAAIJ,MAAM,KAAK,CAAC,IAAIC,KAAK,KAAK,CAAE,EAAE;YAC9EL,oCAAoC,EAAE;YACtCd,MAAM,CAACoB,KAAK,CAAC;YAEb,OAAO,KAAK;;UAGhB,IAAIR,sBAAsB,KAAK,IAAI,EAAE;YACjC,OAAOA,sBAAsB,CAACI,OAAO,EAAEC,GAAG,EAAEC,MAAM,EAAEC,KAAK,EAAEC,KAAK,CAAC;;QAEzE,CAAC;QAEDhB,MAAM,CAACS,OAAO,GAAG,YAAK;UAClBC,oCAAoC,EAAE;UACtC;UACAd,MAAM,CAAC,IAAIC,WAAW,EAAE,CAAC;QAC7B,CAAC;QACDG,MAAM,CAACmB,MAAM,GAAG,YAAK;UACjBT,oCAAoC,EAAE;UACtCf,OAAO,EAAE;QACb,CAAC;QACDK,MAAM,CAACa,GAAG,GAAGR,GAAG;QAChBL,MAAM,CAACI,IAAI,GAAG,QAAQ;QAEtBN,IAAI,CAACsB,WAAW,CAACpB,MAAM,CAAC;;IAEhC,CAAC,CAAC;EAAA;AACV,CAAC","names":["createEvaluateSource","window","source","Promise","resolve","reject","SyntaxError","head","document","script","createElement","blob","Blob","type","url","URL","createObjectURL","originalOnErrorHandler","onerror","removeErrorEventListenerAndRevokeUrl","revokeObjectURL","message","src","lineno","colno","error","location","href","onload","appendChild"],"sourceRoot":"","sources":["../../../src/factories/evaluate-source.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}