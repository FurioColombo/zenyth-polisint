{"ast":null,"code":"import { withModifiers as _withModifiers, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-273ec18e\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"filter\"\n};\nconst _hoisted_2 = [\"textContent\"];\nconst _hoisted_3 = {\n  class: \"filter_back\",\n  ref: \"filter_back\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"logo_text\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"logo_text\"\n};\nconst _hoisted_6 = {\n  key: 3,\n  class: \"logo_BD_back\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", {\n    class: \"modDot\",\n    style: _normalizeStyle($options.computedModulation('filter')),\n    onClick: _cache[0] || (_cache[0] = _withModifiers($event => $options.unlinkMod('filter'), [\"shift\", \"stop\"])),\n    textContent: _toDisplayString($options.computedModText('filter'))\n  }, null, 12 /* STYLE, PROPS */, _hoisted_2), _createElementVNode(\"div\", _hoisted_3, null, 512 /* NEED_PATCH */), _createElementVNode(\"div\", {\n    class: \"filter_logo\",\n    style: _normalizeStyle(this.filter_logo),\n    onMousedown: _cache[6] || (_cache[6] = (...args) => $options.logoDown && $options.logoDown(...args))\n  }, [$data.is_logoDown && $data.type != 'peaking' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, _toDisplayString(((1 - this.resonance) * 100).toFixed() + \"%\"), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), $data.is_logoDown && $data.type == 'peaking' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, _toDisplayString(((1 - 2 * this.resonance) * 100).toFixed() + \"%\"), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\"<div v-if=\\\"type==='peaking'\\\" class=\\\"logo_BD_mask\\\" :style=\\\"computedBDMaks\\\"></div> \"), _createElementVNode(\"div\", {\n    class: \"logo_glow\",\n    style: _normalizeStyle($options.computedGlow)\n  }, null, 4 /* STYLE */), _createElementVNode(\"div\", {\n    class: \"logo_border\",\n    onDragenter: [_cache[1] || (_cache[1] = $event => $options.handleDragEnter('filter')), _cache[3] || (_cache[3] = _withModifiers(() => {}, [\"prevent\"]))],\n    onDragleave: _cache[2] || (_cache[2] = $event => $options.handleDragLeave('filter')),\n    onDragover: _cache[4] || (_cache[4] = _withModifiers(() => {}, [\"prevent\"])),\n    onDrop: _cache[5] || (_cache[5] = $event => $options.handleDrop($event, 'filter'))\n  }, null, 32 /* HYDRATE_EVENTS */), _createElementVNode(\"div\", {\n    class: \"logo\",\n    style: _normalizeStyle($options.logo)\n  }, [$data.is_logoDown ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: \"logo_text_back\",\n    style: _normalizeStyle(this.logo_text_back)\n  }, null, 4 /* STYLE */)) : _createCommentVNode(\"v-if\", true), $data.type === 'lowpass' ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 1,\n    class: \"logo_LP\",\n    style: _normalizeStyle($options.computedLP)\n  }, null, 4 /* STYLE */)) : _createCommentVNode(\"v-if\", true), $data.type === 'highpass' ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 2,\n    class: \"logo_HP\",\n    style: _normalizeStyle($options.computedHP)\n  }, null, 4 /* STYLE */)) : _createCommentVNode(\"v-if\", true), $data.type === 'peaking' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6)) : _createCommentVNode(\"v-if\", true), $data.type === 'peaking' ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 4,\n    class: \"logo_BD_circle\",\n    style: _normalizeStyle($options.computedBDCircle)\n  }, null, 4 /* STYLE */)) : _createCommentVNode(\"v-if\", true)], 4 /* STYLE */)], 36 /* STYLE, HYDRATE_EVENTS */)]);\n}","map":{"version":3,"mappings":";;;EACOA,KAAK,EAAC;AAAQ;;;EAGZA,KAAK,EAAC,aAAa;EAACC,GAAG,EAAC;;;;EAKkBD,KAAK,EAAC;;;;EAGNA,KAAK,EAAC;;;;EAsBlBA,KAAK,EAAC;;;uBAjC3CE,oBAyCM,OAzCNC,UAyCM,GAxCJC,oBAC8C;IADzCJ,KAAK,EAAC,QAAQ;IAAEK,KAAK,kBAAEC,2BAAkB;IAAaC,OAAK,qDAAaD,kBAAS;iBACjFE,iBAAQF,QAA0B,gBAAX;+CAC5BF,oBAGM,OAHNK,UAGM,+BACNL,oBAiCM;IAjCDJ,KAAK,EAAC,aAAa;IAAEK,KAAK,uBAAOK,WAAW;IAAGC,WAAS,yCAAEL,+CAAQ;MAC1DM,iBAAW,IAAIA,UAAI,+BAA9BV,oBAEM,OAFNW,UAEM,8BADUC,SAAS,SAASC,OAAO,+DAE9BH,iBAAW,IAAIA,UAAI,+BAA9BV,oBAEM,OAFNc,UAEM,kCADcF,SAAS,SAASC,OAAO,+DAE7CE,8GAAwF,EACxFb,oBAAmD;IAA9CJ,KAAK,EAAC,WAAW;IAAEK,KAAK,kBAAEC,qBAAY;2BAE3CF,oBAGO;IAHFJ,KAAK,EAAC,aAAa;IAClBkB,WAAS,uCAAEZ,wBAAe,sDAC3B,QAAkB;IADsBa,WAAS,sCAAEb,wBAAe;IAC9Cc,UAAQ,2CAAT,QAAiB;IAAEC,MAAI,sCAAEf,mBAAU,CAACgB,MAAM;qCAElElB,oBAkBM;IAlBDJ,KAAK,EAAC,MAAM;IAAEK,KAAK,kBAAEC,aAAI;MACjBM,iBAAW,kBAAtBV,oBAAkF;;IAA1DF,KAAK,EAAC,gBAAgB;IAAEK,KAAK,uBAAOkB,cAAc;gEAEhEX,UAAI,gCADdV,oBAIO;;IAFHF,KAAK,EAAC,SAAS;IACdK,KAAK,kBAAEC,mBAAU;gEAGZM,UAAI,iCADdV,oBAIO;;IAFHF,KAAK,EAAC,SAAS;IACdK,KAAK,kBAAEC,mBAAU;gEAEXM,UAAI,gCAAfV,oBAA0D,OAA1DsB,UAA0D,wCAEhDZ,UAAI,gCADdV,oBAIO;;IAFHF,KAAK,EAAC,gBAAgB;IACrBK,KAAK,kBAAEC,yBAAgB","names":["class","ref","_createElementBlock","_hoisted_1","_createElementVNode","style","$options","onClick","_toDisplayString","_hoisted_3","filter_logo","onMousedown","$data","_hoisted_4","resonance","toFixed","_hoisted_5","_createCommentVNode","onDragenter","onDragleave","onDragover","onDrop","$event","logo_text_back","_hoisted_6"],"sourceRoot":"","sources":["/Users/guglielmofratticioli/Documents/POLIMI/FurioColombo.github.io/src/views/Synth/Filters/Filter.vue"],"sourcesContent":["<template>\n  <div class=\"filter\">\n    <div class=\"modDot\" :style=\"computedModulation('filter')\" @click.shift.stop=\"unlinkMod('filter')\"\n         v-text=\"computedModText('filter')\"></div>\n    <div class=\"filter_back\" ref=\"filter_back\"\n         >\n\n    </div>\n    <div class=\"filter_logo\" :style=\"this.filter_logo\" @mousedown=\"logoDown\">\n      <div v-if=\"is_logoDown && type != 'peaking'\" class=\"logo_text\">\n        {{ ((1 - this.resonance) * 100).toFixed() + \"%\" }}\n      </div>\n      <div v-if=\"is_logoDown && type == 'peaking'\" class=\"logo_text\">\n        {{ ((1 - 2 * this.resonance) * 100).toFixed() + \"%\" }}\n      </div>\n      <!--<div v-if=\"type==='peaking'\" class=\"logo_BD_mask\" :style=\"computedBDMaks\"></div> -->\n      <div class=\"logo_glow\" :style=\"computedGlow\"></div>\n\n      <div class=\"logo_border\"\n           @dragenter=\"handleDragEnter('filter')\" @dragleave=\"handleDragLeave('filter')\"\n           @dragenter.prevent @dragover.prevent @drop=\"handleDrop($event, 'filter')\"\n      ></div>\n      <div class=\"logo\" :style=\"logo\">\n        <div v-if=\"is_logoDown\" class=\"logo_text_back\" :style=\"this.logo_text_back\"></div>\n        <div\n            v-if=\"type === 'lowpass'\"\n            class=\"logo_LP\"\n            :style=\"computedLP\"\n        ></div>\n        <div\n            v-if=\"type === 'highpass'\"\n            class=\"logo_HP\"\n            :style=\"computedHP\"\n        ></div>\n        <div v-if=\"type === 'peaking'\" class=\"logo_BD_back\"></div>\n        <div\n            v-if=\"type === 'peaking'\"\n            class=\"logo_BD_circle\"\n            :style=\"computedBDCircle\"\n        ></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport MyFilter from \"@/views/Synth/Filters/MyFilter\";\n\nexport default {\n  props: [\"filter_type\", \"chainId\", \"chainColor\", \"id\"],\n\n  data() {\n    return {\n      color: this.colors.yellow,\n      type: this.filter_type,\n      cutoff: 0.5,  //DON'T CHANGE FROM HERE, CHANGE PRESET INSIDE MYFILTER\n      resonance: 0.5, //DON'T CHANGE FROM HERE, CHANGE PRESET INSIDE MYFILTER\n      is_logoDown: false,\n\n      modulator: null,\n    }\n  },\n  mounted() {\n    // mouse event listeners\n    document.addEventListener(\"mousemove\", this.onMouseMove);\n    document.addEventListener(\"mouseup\", this.onMouseUp);\n\n    //console.log(this.$props)\n\n    // -------------- AUDIO ---------------\n    this.filter = new MyFilter(this.type, this.cutoff, this.resonance);\n\n    this.cutoff = this.filter.getCutoff()\n    this.resonance = this.filter.getResonance()\n\n\n    //console.log(this.chainId+\" \"+this.id)\n    //Inserting filter in global variable\n    this.filterChains[this.chainId][this.id] = this.filter;\n\n    if (this.id === this.nFiltersXchain - 1 && this.chainId === this.nFilterChains - 1) {\n      this.$emit(\"filtersMounted\");\n    }\n\n  },\n\n  methods: {\n    //------------DRAG AND DROP LOGIC---------\n    handleDrop(event, target = \"\") {\n      if (this.modulator === null) {\n        let data = JSON.parse(event.dataTransfer.getData(\"data\"));\n        this.modulator = {color: data.color, id: data.id, type: data.type}\n        //console.log(\"RECEIVED HANDLEDROP, THIS.MODULATOR=\")\n        //console.log(this.modulator)\n        document.dispatchEvent(new CustomEvent(\"link\", {\n          detail: {\n            object: this.filter,\n            target: target,\n            color: this.color[\"light\"],\n            modulator: {type: this.modulator.type, id: this.modulator.id}\n          }}\n        ))\n      }\n\n    },\n    handleDragEnter(target) {\n      //todo: highlight object when dragging on it\n      console.log(\"Dragging over \" + target)\n    },\n    handleDragLeave(target) {\n      console.log(\"Dragging out of \" + target)\n    },\n    unlinkMod(target) {\n      //todo: CALL BACK ENVELOPS TO UNLINK\n      document.dispatchEvent(new CustomEvent(\"unLink\", {\n            detail: {\n              object: this.filter,\n              target: target,\n              modulator: {type: this.modulator.type, id: this.modulator.id}\n            }\n          }\n      ))\n\n      //re-hide link dot\n      this.modulator = null;\n\n    },\n    //--------DRAG AND DROP STYLING--------\n    computedModulation(target = \"\") {\n      if (this.modulator) {\n        return {\n          width: \"1vw\",\n          height: \"1vw\",\n          borderRadius: \"50%\",\n          backgroundColor: this.modulator.color,\n          position: \"absolute\",\n          left: \"10%\",\n          zIndex: \"1\",\n          top: \"10%\",\n        };\n      } else {\n        return {\n          display: \"none\",\n          width: \"0%\",\n          height: \"0%\",\n        }\n      }\n    },\n    computedModText(target = \"\") {\n      if (this.modulator) {\n        return this.modulator.id\n      } else return \"\";\n    },\n\n    //------------------------------------\n\n    // ----------- USER EVENTS -----------\n    onMouseMove(event) {\n      if (this.is_logoDown) {\n        if (event.movementY < 0) {\n          // Mouse is moving up\n          this.resonance = Math.max(this.resonance + event.movementY / 100, 0);\n          //console.log(\"moving up\");\n        } else {\n          // Mouse is moving down\n          this.resonance = Math.min(this.resonance + event.movementY / 100, 1);\n        }\n        if (event.movementX < 0) {\n          // Mouse is moving right\n          this.cutoff = Math.max(\n              this.cutoff + Math.floor(event.movementX) / 100,\n              0\n          );\n        } else if (event.movementX > 0) {\n          // Mouse is moving left\n          this.cutoff = Math.min(\n              this.cutoff + Math.floor(event.movementX) / 100,\n              1\n          );\n        }\n        // ----------- audio ---------\n        this.filter.setResonance(this.resonance);\n        this.filter.setCutoff(this.cutoff);\n      }\n    },\n\n    onMouseUp() {\n      if (this.is_logoDown) this.is_logoDown = false;\n      document.body.style.cursor = \"pointer\";\n    },\n    logoDown() {\n      if (!this.is_logoDown) {\n        this.is_logoDown = true;\n        document.body.style.cursor = \"none\";\n      }\n    },\n\n    // ----------- AUDIO SETTERS--------------\n    setCutoff(cutoff = this.cutoff) {\n      this.cutoff = cutoff;\n      this.filter.setCutoff(this.cutoff)\n    },\n\n    setResonance(resonance = this.resonance) {\n      this.resonance = resonance\n      this.filter.setResonance(this.resonance)\n    },\n\n    connect(destination) {\n      this.filter.connect(destination);\n    },\n\n    disconnect(destination) {\n      this.filter.disconnect(destination)\n    },\n\n    // ------------ GETTERS SETTERS -------------\n    getToneFilter() {\n      return this.filter.getToneFilter();\n    },\n\n    getMyFilter() {\n      return this.filter;\n    },\n  },\n\n  computed: {\n    computedHeadStyle() {\n      return {\n        left: 0.7 * this.cutoff * 100 + 13.5 + \"%\",\n      };\n    },\n    computedGlow() {\n      if (this.filter_type === \"peaking\" && this.resonance < 0.5) {\n        return {\n          opacity: 1 - 2 * this.resonance,\n          background: this.colors.yellow.light,\n        };\n      } else if (this.filter_type === \"peaking\" && this.resonance >= 0.5) {\n        return {\n          opacity: 2 * this.resonance - 1,\n          background: this.colors.yellow.light,\n        };\n      } else {\n        return {\n          opacity: 1 - this.resonance,\n          background: this.colors.yellow.light,\n        };\n      }\n    },\n    computedLP() {\n      return {\n        transform: \"translateX(\" + (-100 + this.cutoff * 100)  + \"%)\",\n      };\n    },\n    computedHP() {\n      return {\n        transform: \"translateX(\" + this.cutoff * 100 + \"%)\",\n      };\n    },\n    computedBDMaks() {\n      let clip = \"\";\n      if (this.resonance > 0.5)\n        clip = \"polygon(0% 0%, 100% 0%, 100% 50%, 0% 50%)\";\n      else if (this.resonance < 0.5)\n        clip = \"polygon(0% 50%, 0% 100%, 100% 100%, 100% 50%)\";\n      else clip = \"polygon(0% 0%, 100% 0%, 100% 50%, 0% 50%)\";\n      return {\n        clipPath: clip,\n      };\n    },\n    computedBD() {\n      if (1 - this.resonance >= 0.5) {\n        return {\n          //transform: 'translateY(' + (this.resonance > .5 ? -100 + this.resonance * 100 : this.resonance * 100) + '%)',\n          height: (1 - this.resonance) * 100 + \"%\",\n          transform: \"translateX(\" + this.cutoff * 100 + \"%)\",\n        };\n      } else {\n        return {\n          //transform: 'translateY(' + (this.resonance > .5 ? -100 + this.resonance * 100 : this.resonance * 100) + '%)',\n          height: (1 - this.resonance - 0.5) * 100 + \"%\",\n          transform: \"translateX(\" + (this.cutoff - 0.5) * 100 + \"%)\",\n        };\n      }\n    },\n    computedBDCircle() {\n      return {\n        transform:\n            \"translate(\" +\n            (this.cutoff - 0.5) * 100 +\n            \"%, \" +\n            (this.resonance - 0.5) * 100 +\n            \"%)\",\n        //transform: 'translateX('+(this.cutoff-.5)*100+'%)'\n      };\n    },\n    filter_logo() {\n      return {\n        background: this.colors.yellow.glow\n      }\n    },\n    logo() {\n      return {\n        background: this.colors.yellow.light\n      }\n    },\n    logo_text_back() {\n      return {\n        background: this.colors.yellow.light,\n      }\n    }\n  },\n};\n</script>\n\n<style scoped>\n.modDot {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 0.8vw;\n  text-align: center;\n  box-sizing: border-box;\n  border: .06vw solid black;\n}\n.filter {\n  position: relative;\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 4;\n}\n\n.filter_back {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  width: 80%;\n  height: 80%;\n  background-color: transparent;\n  justify-content: center;\n  align-items: center;\n}\n\n.filter_logo {\n  position: absolute;\n  display: flex;\n  flex: 5;\n\n  height: 100%;\n  top: 0;\n  aspect-ratio: 1/1;\n  border-radius: 50%;\n  z-index: 0;\n  clip-path: circle(50%);\n  justify-content: center;\n  align-items: center;\n}\n\n.logo_border {\n  position: absolute;\n  height: 70%;\n  aspect-ratio: 1/1;\n  z-index: 5;\n  border-radius: 50%;\n  border: 0.1vw solid #3b210e;\n}\n\n.logo {\n  position: absolute;\n  height: 70%;\n  aspect-ratio: 1/1;\n  z-index: 3;\n  clip-path: circle(50%);\n}\n\n.logo_glow {\n  position: absolute;\n  height: 90%;\n  aspect-ratio: 1/1;\n  border-radius: 50%;\n  z-index: 1;\n  filter: blur(0.3vw);\n}\n\n.logo_text {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1vw;\n  font-weight: bold;\n  position: absolute;\n  height: 100%;\n  aspect-ratio: 1/1;\n  border-radius: 50%;\n  color: black;\n  opacity: 100%;\n  background-color: black;\n  z-index: 5;\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.logo_text_back {\n  position: absolute;\n  z-index: 6;\n  left: 15%;\n  top: 30%;\n  width: 70%;\n  height: 40%;\n  opacity: 100%;\n  border-radius: 10%;\n}\n\n.logo_LP {\n  opacity: 60%;\n  display: flex;\n  position: absolute;\n  height: 100%;\n  aspect-ratio: 1/1;\n  border-radius: 50%;\n  border: .1vw solid black;\n  background-color: #faf8ef;\n  z-index: 1;\n}\n\n.logo_HP {\n  opacity: 60%;\n  display: flex;\n  position: absolute;\n  height: 100%;\n  aspect-ratio: 1/1;\n  border-radius: 50%;\n  border: .1vw solid black;\n  background-color: #faf8ef;\n  z-index: 1;\n}\n.logo_BD_circle {\n  opacity: 60%;\n  position: absolute;\n  width: 100%;\n  aspect-ratio: 1/1;\n  border: .1vw solid black;\n  border-radius: 50%;\n  background-color: #faf8ef;\n  z-index: 5;\n}\n\n.logo_BD_mask {\n  opacity: 60%;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  border: .1vw solid black;\n  background-color: #ffebd2;\n  z-index: 2;\n}\n\n.logo_BD {\n  display: flex;\n  position: absolute;\n  height: 100%;\n  aspect-ratio: 1/1;\n  border-radius: 50%;\n  background-color: white;\n  z-index: 1;\n}\n\n.logo_BD_line {\n  position: absolute;\n  width: 100%;\n  height: 4%;\n  top: 48%;\n  filter: blur(0.02vw);\n  border-radius: 30%;\n  background-color: #e58138;\n  z-index: 5;\n}\n\n\n.logo_BD_circle {\n  position: absolute;\n  width: 100%;\n  aspect-ratio: 1/1;\n\n  border-radius: 50%;\n  background-color: #faf8ef;\n  z-index: 5;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}