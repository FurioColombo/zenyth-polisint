{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.string.link.js\";\nimport Envelope from \"./Envelope.vue\";\nimport Lfo from \"./Lfo.vue\";\nimport VolEnvelope from \"./VolEnvelope.vue\";\nimport ModSelector from \"./ModSelector.vue\";\nimport { toRaw } from 'vue';\nexport default {\n  components: {\n    VolEnvelope: VolEnvelope,\n    Envelope: Envelope,\n    Lfo: Lfo,\n    ModSelector: ModSelector\n  },\n  data: function data() {\n    return {\n      name: \"modHost\",\n      //number of total modulators\n\n      //visible modulator\n      selection: 'volEnvelope',\n      selectionType: null,\n      //list of modulators\n      envList: [],\n      lfoList: []\n    };\n  },\n  created: function created() {\n    //create arrays of modulators\n    for (var i = 1; i < this.nEnvelopes + 1; i++) {\n      this.envList.push({\n        id: i,\n        ref: i\n      });\n    }\n    for (var _i = 1; _i < this.nLfo + 1; _i++) {\n      this.lfoList.push({\n        id: _i,\n        ref: _i\n      });\n    }\n    //console.log(toRaw(this.modulatorList));\n  },\n  mounted: function mounted() {\n    //unhide main volume modulator\n    this.$refs.volEnvelope.unHide();\n    //console.log(this.$refs.volEnvelope)\n\n    //listens to link and unlink events\n    document.addEventListener(\"link\", this.handleLink);\n    document.addEventListener(\"unLink\", this.handleUnlink);\n  },\n  computed: {\n    modHost: function modHost() {\n      return {\n        background: this.colors.gray.glow\n      };\n    }\n  },\n  methods: {\n    handleDraggableUpdate: function handleDraggableUpdate(isDraggable) {\n      this.$refs.modSelector.isDraggableUpdate(isDraggable);\n    },\n    handleNewOsc: function handleNewOsc() {\n      //initialize volEnvelope on all synth when a new oscillator is added\n      this.$refs.volEnvelope.handleNewOsc();\n    },\n    handleMouseUp: function handleMouseUp(e) {\n      if (this.selection === 'volEnvelope') {\n        this.$refs.volEnvelope.handleMouseUp(e);\n      } else {\n        if (this.selectionType === \"envelope\") {\n          toRaw(toRaw(this.$refs.envelopes)[this.selection - 1]).handleMouseUp(e);\n        }\n        if (this.selectionType === \"lfo\") {\n          toRaw(toRaw(this.$refs.lfos)[this.selection - 1]).handleMouseUp(e);\n        }\n      }\n    },\n    handleMouseMove: function handleMouseMove(e) {\n      if (this.selection === 'volEnvelope') {\n        this.$refs.volEnvelope.handleMouseMove(e);\n      } else {\n        if (this.selectionType === \"envelope\") {\n          toRaw(toRaw(this.$refs.envelopes)[this.selection - 1]).handleMouseMove(e);\n        }\n        if (this.selectionType === \"lfo\") {\n          toRaw(toRaw(this.$refs.lfos)[this.selection - 1]).handleMouseMove(e);\n        }\n      }\n    },\n    changeSelection: function changeSelection(id, type) {\n      //console.log(\"selected \"+id)\n      //console.log(this.$refs)\n\n      //hide old modulator\n      if (this.selection === 'volEnvelope') {\n        this.$refs.volEnvelope.hide();\n      } else {\n        if (this.selectionType === \"envelope\") {\n          toRaw(toRaw(this.$refs.envelopes)[this.selection - 1]).hide();\n        }\n        if (this.selectionType === \"lfo\") {\n          toRaw(toRaw(this.$refs.lfos)[this.selection - 1]).hide();\n          toRaw(toRaw(this.$refs.lfos)[this.selection - 1]).stopOscilloscope();\n        }\n      }\n\n      //show new modulator\n      if (id === 'volEnvelope') {\n        this.$refs.volEnvelope.unHide();\n      } else {\n        if (type === \"envelope\") {\n          toRaw(toRaw(this.$refs.envelopes)[id - 1]).unHide();\n        }\n        if (type === \"lfo\") {\n          toRaw(toRaw(this.$refs.lfos)[id - 1]).unHide();\n        }\n      }\n      this.selection = id;\n      this.selectionType = type;\n    },\n    //handlers for drag and drop\n    handleLink: function handleLink(event) {\n      //console.log(\"link\")\n      var data = event.detail;\n      //console.log(data)\n      //console.log(this.synths)\n      this.$refs[data.modulator.type + \"s\"][data.modulator.id - 1].link(data.object, data.target, data.color);\n    },\n    handleUnlink: function handleUnlink(event) {\n      //console.log(\"unLink\")\n      var data = event.detail;\n      this.$refs[data.modulator.type + \"s\"][data.modulator.id - 1].unLink(data.object, data.target);\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["Envelope","Lfo","VolEnvelope","ModSelector","toRaw","components","data","name","selection","selectionType","envList","lfoList","created","i","nEnvelopes","push","id","ref","nLfo","mounted","$refs","volEnvelope","unHide","document","addEventListener","handleLink","handleUnlink","computed","modHost","background","colors","gray","glow","methods","handleDraggableUpdate","isDraggable","modSelector","isDraggableUpdate","handleNewOsc","handleMouseUp","e","envelopes","lfos","handleMouseMove","changeSelection","type","hide","stopOscilloscope","event","detail","modulator","link","object","target","color","unLink"],"sourceRoot":"","sources":["C:\\Home\\Projects\\Programmazione\\WebStorm\\myZenythPolisinT\\zenyth_polisint\\src\\views\\Synth\\Modulators\\ModHost.vue"],"sourcesContent":["<template>\r\n  <div class=\"modHost\" :style=\"modHost\">\r\n     <VolEnvelope ref=\"volEnvelope\"/>\r\n    <template\r\n      v-for=\"modulator in envList\"\r\n      :key=\"modulator.id\">\r\n\r\n       <Envelope\r\n        :id=\"modulator.id\"\r\n        ref=\"envelopes\"\r\n      @isDraggableUpdate=\"handleDraggableUpdate\"/>\r\n    </template>\r\n    <template\r\n        v-for=\"modulator in lfoList\"\r\n        :key=\"modulator.id\">\r\n\r\n\r\n       <Lfo\r\n          :id=\"modulator.id\"\r\n          ref=\"lfos\"/>\r\n    </template>\r\n    <ModSelector\r\n      @selection=\"changeSelection\"\r\n      ref=\"modSelector\"/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Envelope from \"./Envelope.vue\";\r\nimport Lfo from \"./Lfo.vue\";\r\nimport VolEnvelope from \"./VolEnvelope.vue\";\r\nimport ModSelector from \"./ModSelector.vue\";\r\nimport { toRaw } from 'vue';\r\n\r\nexport default {\r\n  components: {\r\n    VolEnvelope,\r\n    Envelope,\r\n    Lfo,\r\n    ModSelector,\r\n  },\r\n  data() {\r\n    return {\r\n      name: \"modHost\",\r\n      //number of total modulators\r\n\r\n      //visible modulator\r\n      selection: 'volEnvelope',\r\n      selectionType: null,\r\n\r\n      //list of modulators\r\n      envList: [],\r\n      lfoList: [],\r\n    };\r\n  },\r\n  created() {\r\n    //create arrays of modulators\r\n    for (let i = 1; i < this.nEnvelopes+1; i++) {\r\n      this.envList.push({ id: i, ref: i });\r\n    }\r\n    for (let i = 1; i < this.nLfo+1; i++) {\r\n      this.lfoList.push({ id: i, ref: i });\r\n    }\r\n    //console.log(toRaw(this.modulatorList));\r\n  },\r\n  mounted() {\r\n    //unhide main volume modulator\r\n    this.$refs.volEnvelope.unHide();\r\n    //console.log(this.$refs.volEnvelope)\r\n\r\n    //listens to link and unlink events\r\n    document.addEventListener(\"link\", this.handleLink)\r\n    document.addEventListener(\"unLink\", this.handleUnlink)\r\n  },\r\n  computed: {\r\n    modHost() {\r\n      return{\r\n        background: this.colors.gray.glow,\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    handleDraggableUpdate(isDraggable){\r\n      this.$refs.modSelector.isDraggableUpdate(isDraggable)\r\n    },\r\n    handleNewOsc(){\r\n      //initialize volEnvelope on all synth when a new oscillator is added\r\n      this.$refs.volEnvelope.handleNewOsc();\r\n    },\r\n    handleMouseUp(e){\r\n      if(this.selection==='volEnvelope'){\r\n        this.$refs.volEnvelope.handleMouseUp(e)\r\n      }else{\r\n        if(this.selectionType===\"envelope\"){\r\n          toRaw(toRaw(this.$refs.envelopes)[this.selection-1]).handleMouseUp(e);\r\n        }\r\n        if(this.selectionType===\"lfo\"){\r\n          toRaw(toRaw(this.$refs.lfos)[this.selection-1]).handleMouseUp(e);\r\n        }\r\n      }\r\n    },\r\n    handleMouseMove(e){\r\n      if(this.selection==='volEnvelope'){\r\n        this.$refs.volEnvelope.handleMouseMove(e)\r\n      }else{\r\n        if(this.selectionType===\"envelope\"){\r\n          toRaw(toRaw(this.$refs.envelopes)[this.selection-1]).handleMouseMove(e);\r\n        }\r\n        if(this.selectionType===\"lfo\"){\r\n          toRaw(toRaw(this.$refs.lfos)[this.selection-1]).handleMouseMove(e);\r\n        }\r\n      }\r\n    },\r\n    changeSelection(id, type) {\r\n      //console.log(\"selected \"+id)\r\n      //console.log(this.$refs)\r\n\r\n      //hide old modulator\r\n      if(this.selection==='volEnvelope'){\r\n        this.$refs.volEnvelope.hide()\r\n      }else{\r\n        if(this.selectionType===\"envelope\"){\r\n          toRaw(toRaw(this.$refs.envelopes)[this.selection-1]).hide();\r\n        }\r\n        if(this.selectionType===\"lfo\"){\r\n          toRaw(toRaw(this.$refs.lfos)[this.selection-1]).hide();\r\n          toRaw(toRaw(this.$refs.lfos)[this.selection-1]).stopOscilloscope();\r\n        }\r\n      }\r\n\r\n\r\n      //show new modulator\r\n      if(id==='volEnvelope'){\r\n        this.$refs.volEnvelope.unHide()\r\n      }else{\r\n        if(type===\"envelope\"){\r\n          toRaw(toRaw(this.$refs.envelopes)[id-1]).unHide();\r\n        }\r\n        if(type===\"lfo\"){\r\n          toRaw(toRaw(this.$refs.lfos)[id-1]).unHide();\r\n        }\r\n      }\r\n\r\n\r\n      this.selection = id;\r\n      this.selectionType = type;\r\n      \r\n    },\r\n\r\n    //handlers for drag and drop\r\n    handleLink(event){\r\n      //console.log(\"link\")\r\n      let data = event.detail\r\n      //console.log(data)\r\n      //console.log(this.synths)\r\n      this.$refs[data.modulator.type+\"s\"][data.modulator.id-1].link(data.object, data.target, data.color)\r\n    },\r\n    handleUnlink(event){\r\n      //console.log(\"unLink\")\r\n      let data = event.detail\r\n      this.$refs[data.modulator.type+\"s\"][data.modulator.id-1].unLink(data.object, data.target)\r\n\r\n    }\r\n\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modHost {\r\n  grid-column: span 2; /* takes 2 spaces horizontally*/\r\n  position: relative;\r\n  display: grid;\r\n  grid-template-rows: 80% 20%;\r\n  grid-template-columns: 100%;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}