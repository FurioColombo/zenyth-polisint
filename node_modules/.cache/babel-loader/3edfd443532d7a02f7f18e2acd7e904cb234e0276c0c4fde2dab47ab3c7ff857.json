{"ast":null,"code":"import * as Tone from \"tone\";\nimport { dbToGain, gainToDb } from \"tone\";\nexport default {\n  data() {\n    return {\n      timing: 10\n    };\n  },\n  mounted() {\n    this.analyser = new Tone.Analyser(\"fft\", 2048);\n    this.canvasCtx = this.$refs.canvas.getContext(\"2d\");\n    Tone.getDestination().connect(this.analyser);\n    this.startAnalyzer();\n  },\n  methods: {\n    draw() {\n      //requestAnimationFrame(this.draw);\n\n      this.data = this.analyser.getValue();\n      this.canvasCtx.strokeStyle = \"#658060\";\n      //console.log(this.data)\n\n      // clear the canvas\n      this.canvasCtx.clearRect(0, 0, this.$refs.canvas.width, this.$refs.canvas.height);\n      let x;\n\n      // render the analysis on the canvas\n      for (let i = 0; i < this.data.length; i++) {\n        this.value = 6 * dbToGain(this.data[i]) * this.$refs.canvas.height;\n        //console.log(this.value)\n        x = Math.log10(i) / Math.log10(2048) * this.$refs.canvas.width;\n        this.canvasCtx.fillStyle = \"black\";\n        this.canvasCtx.fillRect(x, this.$refs.canvas.height - this.value, 1, this.value);\n      }\n    },\n    startAnalyzer() {\n      //console.log(this.$refs.canvas.height)\n      //console.log(\"avviando analyzer con timer \"+this.timing)\n      this.intervalId = setInterval(() => {\n        this.draw();\n      }, 10);\n    }\n  },\n  computed: {\n    analyzerCanvas() {\n      return {\n        background: this.colors.green.glow\n      };\n    }\n  },\n  beforeDestroy() {}\n};","map":{"version":3,"mappings":"AAOA,OAAO,KAAKA,IAAG,MAAO,MAAM;AAC5B,SAASC,QAAQ,EAAEC,QAAO,QAAS,MAAM;AAEzC,eAAe;EACbC,IAAI,GAAG;IACL,OAAO;MACLC,MAAM,EAAE;IACV,CAAC;EACH,CAAC;EACDC,OAAO,GAAG;IACR,IAAI,CAACC,QAAO,GAAI,IAAIN,IAAI,CAACO,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC;IAC9C,IAAI,CAACC,SAAQ,GAAI,IAAI,CAACC,KAAK,CAACC,MAAM,CAACC,UAAU,CAAC,IAAI,CAAC;IACnDX,IAAI,CAACY,cAAc,EAAE,CAACC,OAAO,CAAC,IAAI,CAACP,QAAQ,CAAC;IAC5C,IAAI,CAACQ,aAAa,EAAC;EACrB,CAAC;EACDC,OAAO,EAAE;IACPC,IAAI,GAAG;MACL;;MAEA,IAAI,CAACb,IAAG,GAAI,IAAI,CAACG,QAAQ,CAACW,QAAQ,EAAE;MACpC,IAAI,CAACT,SAAS,CAACU,WAAU,GAAI,SAAS;MACtC;;MAEA;MACA,IAAI,CAACV,SAAS,CAACW,SAAS,CACtB,CAAC,EACD,CAAC,EACD,IAAI,CAACV,KAAK,CAACC,MAAM,CAACU,KAAK,EACvB,IAAI,CAACX,KAAK,CAACC,MAAM,CAACW,MAAK,CACxB;MACC,IAAIC;;MAIN;MACA,KAAK,IAAIC,IAAI,CAAC,EAAEA,IAAI,IAAI,CAACpB,IAAI,CAACqB,MAAM,EAAED,CAAC,EAAE,EAAE;QAEzC,IAAI,CAACE,KAAI,GAAI,CAAC,GAACxB,QAAQ,CAAC,IAAI,CAACE,IAAI,CAACoB,CAAC,CAAC,CAAC,GAAC,IAAI,CAACd,KAAK,CAACC,MAAM,CAACW,MAAM;QAC9D;QACAC,IAAKI,IAAI,CAACC,KAAK,CAACJ,CAAC,IAAIG,IAAI,CAACC,KAAK,CAAC,IAAI,CAAC,GAAI,IAAI,CAAClB,KAAK,CAACC,MAAM,CAACU,KAAI;QAC/D,IAAI,CAACZ,SAAS,CAACoB,SAAQ,GAAI,OAAO;QAClC,IAAI,CAACpB,SAAS,CAACqB,QAAQ,CAACP,CAAC,EAAE,IAAI,CAACb,KAAK,CAACC,MAAM,CAACW,MAAK,GAAI,IAAI,CAACI,KAAK,EAAE,CAAC,EAAE,IAAI,CAACA,KAAK,CAAC;MAClF;IACF,CAAC;IACDX,aAAa,GAAG;MACd;MACE;MACF,IAAI,CAACgB,UAAS,GAAIC,WAAW,CAAC,MAAM;QAClC,IAAI,CAACf,IAAI,EAAE;MACb,CAAC,EAAE,EAAE,CAAC;IACR;EACF,CAAC;EACDgB,QAAQ,EAAE;IACRC,cAAc,GAAE;MACd,OAAM;QACJC,UAAU,EAAE,IAAI,CAACC,MAAM,CAACC,KAAK,CAACC;MAChC;IACF;EACF,CAAC;EACDC,aAAa,GAAG,CAAC;AACnB,CAAC","names":["Tone","dbToGain","gainToDb","data","timing","mounted","analyser","Analyser","canvasCtx","$refs","canvas","getContext","getDestination","connect","startAnalyzer","methods","draw","getValue","strokeStyle","clearRect","width","height","x","i","length","value","Math","log10","fillStyle","fillRect","intervalId","setInterval","computed","analyzerCanvas","background","colors","green","glow","beforeDestroy"],"sourceRoot":"","sources":["/Users/guglielmofratticioli/Documents/POLIMI/FurioColombo.github.io/src/views/Synth/Tools/SpecAnalyzer.vue"],"sourcesContent":["<template>\n  <div class=\"spectral-analyzer\">\n    <canvas class=\"analyzerCanvas\" ref=\"canvas\" :style=\"this.analyzerCanvas\"></canvas>\n  </div>\n</template>\n\n<script>\nimport * as Tone from \"tone\";\nimport { dbToGain, gainToDb } from \"tone\";\n\nexport default {\n  data() {\n    return {\n      timing: 10,\n    };\n  },\n  mounted() {\n    this.analyser = new Tone.Analyser(\"fft\", 2048);\n    this.canvasCtx = this.$refs.canvas.getContext(\"2d\");\n    Tone.getDestination().connect(this.analyser);\n    this.startAnalyzer()\n  },\n  methods: {\n    draw() {\n      //requestAnimationFrame(this.draw);\n\n      this.data = this.analyser.getValue();\n      this.canvasCtx.strokeStyle = \"#658060\";\n      //console.log(this.data)\n\n      // clear the canvas\n      this.canvasCtx.clearRect(\n        0,\n        0,\n        this.$refs.canvas.width,\n        this.$refs.canvas.height\n      );\n        let x\n\n        \n\n      // render the analysis on the canvas\n      for (let i = 0; i < this.data.length; i++) {\n        \n        this.value = 6*dbToGain(this.data[i])*this.$refs.canvas.height;\n        //console.log(this.value)\n        x = (Math.log10(i) / Math.log10(2048)) * this.$refs.canvas.width\n        this.canvasCtx.fillStyle = \"black\";\n        this.canvasCtx.fillRect(x, this.$refs.canvas.height - this.value, 1, this.value);\n      }\n    },\n    startAnalyzer() {\n      //console.log(this.$refs.canvas.height)\n        //console.log(\"avviando analyzer con timer \"+this.timing)\n      this.intervalId = setInterval(() => {\n        this.draw();\n      }, 10);\n    },\n  },\n  computed: {\n    analyzerCanvas(){\n      return{\n        background: this.colors.green.glow\n      }\n    }\n  },\n  beforeDestroy() {},\n};\n</script>\n\n<style>\n.spectral-analyzer{\n  grid-row: 1;\n  margin: 0.3vw 0.3vw 0.15vw;\n  box-sizing: border-box;\n}\n.analyzerCanvas {\n  width: 100%;\n  height: 100%;\n  border-radius: 0.2vw;\n  border: 0.1vw solid #334030;\n  box-sizing: border-box;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}