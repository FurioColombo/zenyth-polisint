(function(){"use strict";var e={6226:function(e,t,s){var o=s(9242),i=s(3396),n=s.p+"img/zenyth_logo.a8930f6b.png";function a(e,t,s,o,a,r){const l=(0,i.up)("router-link"),h=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("nav",null,[(0,i.Wm)(l,{to:"/"},{default:(0,i.w5)((()=>[(0,i._)("img",{className:"app_logo",src:n,alt:"",onClick:t[0]||(t[0]=(...e)=>r.openAbout&&r.openAbout(...e))})])),_:1})]),(0,i.Wm)(h)],64)}var r={mounted(){},methods:{openAbout(){window.open("http://localhost:8080/about")}}},l=s(89);const h=(0,l.Z)(r,[["render",a]]);var c=h,d=s(2483);const u={class:"mainHost"};function p(e,t,s,o,n,a){const r=(0,i.up)("OscHost"),l=(0,i.up)("FilterHost"),h=(0,i.up)("FxHost"),c=(0,i.up)("ToolHost"),d=(0,i.up)("ModHost"),p=(0,i.up)("PianoKeyboard"),m=(0,i.up)("LFO");return(0,i.wg)(),(0,i.iD)("div",{class:"appContainer",onMouseup:t[0]||(t[0]=(...e)=>a.handleMouseUp&&a.handleMouseUp(...e)),onMousemove:t[1]||(t[1]=(...e)=>a.handleMouseMove&&a.handleMouseMove(...e))},[(0,i._)("div",u,[(0,i.Wm)(r,{ref:"oscHost",onNewOsc:a.handleNewOsc},null,8,["onNewOsc"]),(0,i.Wm)(l,{ref:"filterHost",onFilterInitialized:a.initOscConnections},null,8,["onFilterInitialized"]),(0,i.Wm)(h,{ref:"fxHost"},null,512),(0,i.Wm)(c,{ref:"toolsHost"},null,512),(0,i.Wm)(d,{ref:"modHost"},null,512),(0,i.Wm)(p,{ref:"pianoKeyboard",onNoteDown:a.noteDownHandle,onNoteUp:a.noteUpHandle},null,8,["onNoteDown","onNoteUp"])]),((0,i.wg)(),(0,i.j4)(m,{key:1}))],32)}var m=s(4481),f=s(7139);const v=e=>((0,i.dD)("data-v-822b82c8"),e=e(),(0,i.Cn)(),e),g={class:"scrollable"},y=v((()=>(0,i._)("div",{class:"oscVoid"},"+",-1))),w=[y],b=v((()=>(0,i._)("div",{class:"oscVoid"},"+",-1))),k=[b],_=v((()=>(0,i._)("div",{class:"oscVoid"},"+",-1))),D=[_];function M(e,t,s,o,n,a){const r=(0,i.up)("Osc");return(0,i.wg)(),(0,i.iD)("div",{class:"oscHost",style:(0,f.j5)(this.oscHost)},[(0,i._)("div",g,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.oscList,(e=>((0,i.wg)(),(0,i.j4)(r,{key:e.id,ref_for:!0,ref:e.ref,id:e.id,onDisposed:a.removeOsc,onNewOsc:a.handleNewOsc},null,8,["id","onDisposed","onNewOsc"])))),128)),(0,i._)("div",{class:"voidContainer",onClick:t[0]||(t[0]=(...e)=>a.addOsc&&a.addOsc(...e))},[(0,i._)("div",{class:"voidBorder",style:(0,f.j5)(a.voidBorder)},w,4)]),this.oscList.length<=1?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"voidContainer",onClick:t[1]||(t[1]=(...e)=>a.addOsc&&a.addOsc(...e))},[(0,i._)("div",{class:"voidBorder",style:(0,f.j5)(a.voidBorder)},k,4)])):(0,i.kq)("",!0),this.oscList.length<=0?((0,i.wg)(),(0,i.iD)("div",{key:1,class:"voidContainer",onClick:t[2]||(t[2]=(...e)=>a.addOsc&&a.addOsc(...e))},[(0,i._)("div",{class:"voidBorder",style:(0,f.j5)(a.voidBorder)},D,4)])):(0,i.kq)("",!0)])],4)}s(7658);var C=s.p+"img/sine.83ad3f35.svg",x=s.p+"img/triangle.a36c63c6.svg",I=s.p+"img/saw.fcf7fa8d.svg",L=s.p+"img/square.c0eea307.svg";const F=e=>((0,i.dD)("data-v-a2d87af4"),e=e(),(0,i.Cn)(),e),U={class:"osc"},j={class:"osc_back"},O={class:"osc_middle"},$={class:"osc_front"},P=["textContent"],E=["textContent"],N=["textContent"],T={key:0,src:C,alt:"",draggable:"false"},z={key:1,src:x,alt:"",draggable:"false"},R={key:2,src:I,alt:"",draggable:"false"},S={key:3,src:L,alt:"",draggable:"false"},H=F((()=>(0,i._)("div",null,null,-1))),q=F((()=>(0,i._)("div",null,null,-1)));function A(e,t,s,n,a,r){return(0,i.wg)(),(0,i.iD)("div",{class:"main_container",onClick:t[26]||(t[26]=(0,o.iM)(((...e)=>r.dispose&&r.dispose(...e)),["shift"]))},[(0,i._)("div",{class:"type_button",onClick:t[0]||(t[0]=(...e)=>r.nextOscType&&r.nextOscType(...e)),style:(0,f.j5)(this.type_button)},[(0,i._)("div",{class:"innertext",style:(0,f.j5)(this.type_text)},(0,f.zw)(""===a.osc_types[!0]?"std":a.osc_types[this.oscTypeIndex]),5)],4),(0,i._)("div",{class:"osc_container",style:(0,f.j5)(r.osc_container)},[(0,i._)("div",U,[(0,i._)("div",j,[(0,i._)("div",{class:"mod_area",style:(0,f.j5)(this.mod_area)},null,4),(0,i._)("div",{class:"volume_area",style:(0,f.j5)(this.volume_area)},null,4),(0,i._)("div",{class:"pitch_slider",style:(0,f.j5)(this.pitch_slider)},null,4)]),(0,i._)("div",O,[(0,i._)("div",{class:"mod_slider",ref:"modulation",style:(0,f.j5)(this.mod_slider)},null,4),(0,i._)("div",{class:"volume_slider",ref:"volume",style:(0,f.j5)(this.volume_slider)},null,4)]),(0,i._)("div",$,[(0,i._)("div",{class:"pitch_area",style:(0,f.j5)(this.pitch_area)},null,4),(0,i._)("div",{class:"pitch_hand",ref:"pitch",style:(0,f.j5)(this.pitch_hand)},null,4),(0,i._)("div",{class:"lineL",style:(0,f.j5)(this.lineL)},null,4),(0,i._)("div",{class:"lineU",style:(0,f.j5)(this.lineU)},null,4),(0,i._)("div",{class:"lineR",style:(0,f.j5)(this.lineR)},null,4)]),(0,i._)("div",{class:"draggable left",onDragenter:[t[2]||(t[2]=e=>r.handleDragEnter("mod")),t[4]||(t[4]=(0,o.iM)((()=>{}),["prevent"]))],onDragleave:t[3]||(t[3]=e=>r.handleDragLeave("mod")),onDragover:t[5]||(t[5]=(0,o.iM)((()=>{}),["prevent"])),onDrop:t[6]||(t[6]=e=>r.handleDrop(e,"mod")),onMousedown:t[7]||(t[7]=(...e)=>r.modulationDown&&r.modulationDown(...e))},[(0,i._)("div",{class:"modDot",style:(0,f.j5)(r.computedModulation("mod")),onClick:t[1]||(t[1]=(0,o.iM)((e=>r.unlinkMod("mod")),["shift","stop"])),textContent:(0,f.zw)(r.computedModText("mod"))},null,12,P)],32),(0,i._)("div",{class:"draggable right",onDragenter:[t[9]||(t[9]=e=>r.handleDragEnter("vol")),t[11]||(t[11]=(0,o.iM)((()=>{}),["prevent"]))],onDragleave:t[10]||(t[10]=e=>r.handleDragLeave("vol")),onDragover:t[12]||(t[12]=(0,o.iM)((()=>{}),["prevent"])),onDrop:t[13]||(t[13]=e=>r.handleDrop(e,"vol")),onMousedown:t[14]||(t[14]=(...e)=>r.volumeDown&&r.volumeDown(...e))},[(0,i._)("div",{class:"modDot",style:(0,f.j5)(r.computedModulation("vol")),onClick:t[8]||(t[8]=(0,o.iM)((e=>r.unlinkMod("vol")),["shift","stop"])),textContent:(0,f.zw)(r.computedModText("vol"))},null,12,E)],32),(0,i._)("div",{class:"draggable low",onDragenter:[t[16]||(t[16]=e=>r.handleDragEnter("pitch")),t[18]||(t[18]=(0,o.iM)((()=>{}),["prevent"]))],onDragleave:t[17]||(t[17]=e=>r.handleDragLeave("pitch")),onDragover:t[19]||(t[19]=(0,o.iM)((()=>{}),["prevent"])),onDrop:t[20]||(t[20]=e=>r.handleDrop(e,"pitch")),onMousedown:t[21]||(t[21]=(...e)=>r.pitchDown&&r.pitchDown(...e))},[(0,i._)("div",{class:"modDot",style:(0,f.j5)(r.computedModulation("pitch")),onClick:t[15]||(t[15]=(0,o.iM)((e=>r.unlinkMod("pitch")),["shift","stop"])),textContent:(0,f.zw)(r.computedModText("pitch"))},null,12,N)],32),(0,i._)("div",{class:"osc_wave",onClick:t[22]||(t[22]=(...e)=>r.nextWaveform&&r.nextWaveform(...e)),style:(0,f.j5)(this.osc_wave)},[0===this.oscWaveIndex?((0,i.wg)(),(0,i.iD)("img",T)):(0,i.kq)("",!0),1===this.oscWaveIndex?((0,i.wg)(),(0,i.iD)("img",z)):(0,i.kq)("",!0),2===this.oscWaveIndex?((0,i.wg)(),(0,i.iD)("img",R)):(0,i.kq)("",!0),3===this.oscWaveIndex?((0,i.wg)(),(0,i.iD)("img",S)):(0,i.kq)("",!0)],4)])],4),(0,i._)("div",{class:"chain_buttons",style:(0,f.j5)(r.chain_buttons)},[H,(0,i._)("div",{class:"button_1",style:(0,f.j5)(r.button_1),onClick:t[23]||(t[23]=e=>this.onChainclick(0))},null,4),(0,i._)("div",{class:"button_2",style:(0,f.j5)(r.button_2),onClick:t[24]||(t[24]=e=>this.onChainclick(1))},null,4),(0,i._)("div",{class:"button_3",style:(0,f.j5)(r.button_3),onClick:t[25]||(t[25]=e=>this.onChainclick(2))},null,4),q],4)])}var K=s(686),V=s(2335),G=s(7851),W=s(3255),X=s(4870);const Y=.5;class B{constructor(e="",t=null,s=16){console.log("CONSTRUCTOR HAS BEEN CALLED"),this.destination=t,this.modulatorsData={envelope:{vol:{amount:1,parameters:{attack:1,decay:.3,sustain:.8,release:1}},mod:{amount:0,parameters:{attack:.05,decay:.1,sustain:1,release:.2}},pitch:{amount:0,parameters:{attack:.05,decay:.1,sustain:1,release:.2}}},lfo:{vol:{amount:0,parameters:{frequency:10,waveform:"sine",min:0,max:1}},mod:{amount:0,parameters:{frequency:10,waveform:"sine",min:0,max:1}},pitch:{amount:0,parameters:{frequency:10,waveform:"sine",min:0,max:1}}}},this.synthPreset={type:e,waveform:"sine",vol:-12,transpose:0,mod:0,partials:"",pan:""},this.dampNode=new m.S9(Y),this.gainNode=new m.S9(1),this.allVoices=[],this.freeVoices=[],this.busyVoices={},this.nVoices=s,this.lastNotes=Array(this.nVoices),console.log("COSTRUTTORE CHIAMATO"),this.initVoices(),this.gainNode.connect(this.dampNode),this.dampNode.connect(this.destination)}initVoices(){for(let e=0;e<this.nVoices;e++){let e={envelope:{vol:{amount:1,signal:null,scale:null},mod:{amount:0,signal:null,scale:null},pitch:{amount:0,signal:null,scale:null}},lfo:{vol:{amount:0,signal:null,scale:null},mod:{amount:0,signal:null,scale:null},pitch:{amount:0,signal:null,scale:null}}},t=new m.S9;t.connect(this.gainNode);let s=new m.S9(1).connect(t),o=this.createSynth();o.oscillator.disconnect(),o.oscillator.connect(s),o.envelope.disconnect(),o.envelope.dispose();let i=new m.S9,n=new m.S9,a=new m.cy("pink");a.connect(n),n.connect(i),i.connect(this.dampNode);let r={synth:o,gain:s,lfoGain:t,modulators:e,noise:a,noiseGain:n,noiseAdsrGain:i};for(let l in e)for(let t in e[l]){let s=this.createModulator(l);e[l][t].signal=s,e[l][t].scale=this.createScale(t),this.connectModulator(e[l][t],l,t,r)}this.freeVoices.push(r),this.allVoices.push(r)}this.initialized=!1,this.updateModulators(),this.initialized=!0,console.log(this.freeVoices)}playNote(e,t){if(this.initialized){this.lastNotes.push(e),this.lastNotes.length>this.nVoices&&(this.lastNote=this.lastNotes.shift());let s=this.freeVoices.shift();s||(console.log("NEW NOTE OVERWRITE: "+this.lastNote),s=this.busyVoices[this.lastNote],delete this.busyVoices[this.lastNote]),this.busyVoices[e]=s;for(let e in s.modulators)for(let t in s.modulators[e])if(s.modulators[e][t].amount>0)switch(e){case"envelope":(0,X.IU)(s.modulators[e][t].signal).cancel(m.zO()),(0,X.IU)(s.modulators[e][t].signal).triggerAttack(m.zO());break;case"lfo":(0,X.IU)(s.modulators[e][t]).signal.stop(),(0,X.IU)(s.modulators[e][t]).signal.start();break;default:break}s.synth.oscillator.stop(m.zO()),s.synth.envelope.cancel(m.zO()),s.noise.start(),s.synth.triggerAttack(e,m.zO(),t/128)}}stopNote(e){if(this.initialized&&this.busyVoices[e]){let t=this.busyVoices[e];delete this.busyVoices[e],this.freeVoices.push(t);for(let e in t.modulators)for(let s in t.modulators[e])if(t.modulators[e][s].signal)switch(e){case"envelope":t.modulators[e][s].signal.triggerRelease(m.zO());break;case"lfo":break;default:break}setTimeout((()=>{t.synth.triggerRelease(m.zO()),t.noise.stop()}),1e3*this.modulatorsData.envelope.vol.parameters.release)}}createSynth(){let e=new m.WV;return(0,i.Y3)((()=>{e.set({volume:this.synthPreset.vol,detune:100*this.synthPreset.transpose,oscillator:{type:this.synthPreset.type+this.synthPreset.waveform+this.synthPreset.partials}})})),e}createModulator(e){switch(e){case"envelope":return new m.wr;case"lfo":return new m.Fo;default:return console.log("Error creating modulator"),null}}createScale(e){switch(e){case"vol":return new m.Ci(0,1);case"mod":return new m.Ci(0,1);case"pitch":return new m.Ci(0,1);case"pan":return new m.Ci(0,1);default:return console.log("Error creating scale for target "+e),null}}updateModulators(){this.allVoices.forEach((e=>{for(let t in e.modulators)for(let s in e.modulators[t])e.modulators[t][s].amount=this.modulatorsData[t][s].amount,(0,X.IU)(e.modulators[t][s].signal)||(e.modulators[t][s].signal=this.createModulator(t),e.modulators[t][s].scale=this.createScale(s),this.connectModulator((0,X.IU)(e.modulators[t][s]),t,s,(0,X.IU)(e))),this.scaleSetter(e.modulators[t][s],s),this.modulatorSetter((0,X.IU)(e.modulators[t][s].signal),t,this.modulatorsData[t][s].parameters)}))}updateSynths(){this.allVoices.forEach((e=>{e.synth.set({detune:100*this.synthPreset.transpose,oscillator:{type:this.synthPreset.type+this.synthPreset.waveform+this.synthPreset.partials}}),e.noiseGain.set({gain:this.synthPreset.mod})}))}scaleSetter(e,t){switch(t){case"vol":(0,X.IU)(e.scale).set({min:Math.max(m.xz(this.synthPreset.vol)-e.amount,0),max:Math.min(m.xz(this.synthPreset.vol)+e.amount,1)});break;case"mod":(0,X.IU)(e.scale).set({min:Math.max(this.synthPreset.mod-e.amount,0),max:Math.min(this.synthPreset.mod+e.amount,1)});break;case"pitch":(0,X.IU)(e.scale).set({min:100*(this.synthPreset.transpose-24*e.amount),max:100*(this.synthPreset.transpose+24*e.amount)});break;case"pan":break;default:console.log("invalid target to connect modulator to");break}}modulatorSetter(e,t,s){switch((0,X.IU)(s).waveform||((0,X.IU)(s).waveform=e.type),t){case"envelope":e.set({attack:s.attack,decay:s.decay,sustain:s.sustain,release:s.release+.001});break;case"lfo":e.set({type:(0,X.IU)(s).waveform,frequency:(0,X.IU)(s).frequency});break;default:console.log("Error setting modulator parameters, invalid args");break}}connectModulator(e,t,s,o){switch(t){case"envelope":switch(s){case"vol":e.signal.chain(e.scale,o.gain.gain),e.signal.connect(o.noiseAdsrGain.gain);break;case"mod":e.signal.chain(e.scale,o.noiseGain.gain);break;case"pitch":this.scaleSetter(e,s),e.signal.chain(e.scale,o.synth.detune);break;case"pan":break;default:console.log("invalid target to connect modulator to");break}break;case"lfo":switch(s){case"vol":this.scaleSetter(e,s),e.signal.chain(e.scale,o.lfoGain.gain);break;case"mod":e.signal.chain(e.scale,o.noiseGain.gain);break;case"pitch":this.scaleSetter(e,s),e.signal.chain(e.scale,o.synth.detune);break;case"pan":break;default:console.log("invalid target to connect modulator to");break}break;default:console.log("invalid modulator type");break}}setModulatorParameters(e,t,s){this.initialized&&(this.modulatorsData[e][t].parameters=s,this.updateModulators())}setModulatorAmount(e,t,s){this.initialized&&(this.modulatorsData[e][t].amount=s,this.updateModulators())}setParameters({volume:e=this.synthPreset.vol,modulation:t=this.synthPreset.mod,transpose:s=this.synthPreset.transpose,pan:o=this.synthPreset.pan,type:i=this.synthPreset.type,waveform:n=this.synthPreset.waveform}){this.initialized?(this.synthPreset.vol=e,this.synthPreset.mod=t,this.synthPreset.transpose=s,this.synthPreset.pan=o,this.synthPreset.type=i,this.synthPreset.waveform=n,this.updateSynths(),this.updateModulators()):console.log("Polysynth not initialized")}connect(e){this.gainNode.connect(e)}disconnectDispose(){this.allVoices.forEach((e=>{e=(0,X.IU)(e),e.synth.disconnect(),e.synth.dispose(),e.gain.disconnect(),e.gain.dispose();for(let t in e.modulators)for(let s in e.modulators[t])e.modulators[t][s].signal&&(e.modulators[t][s].signal.disconnect(),e.modulators[t][s].signal.dispose(),e.modulators[t][s].scale.disconnect(),e.modulators[t][s].scale.dispose())})),this.gainNode.disconnect(),this.gainNode.dispose()}}const Z=["sine","triangle","sawtooth","square"],J=["","fm","am","fat"];var Q={components:{SineIcon:K.Z,SquareIcon:V.Z,TriangleIcon:G.Z,SawtoothIcon:W.Z},data(){return{color:{vol:this.colors.pink,mod:this.colors.azure,pitch:this.colors.green},osc_types:["std","fm","am","fat"],volume:.5,modulation:1,pitch:0,pan:0,attack:.01,decay:.1,sustain:1,release:.2,maxPitch:24,minPitch:-24,partials:"",oscWaveIndex:0,oscTypeIndex:0,waveform_btn_style:"lightblue",wave_icon_size:32,is_modulationDown:!1,is_volumeDown:!1,is_pitchDown:!1,isFilterChainRouteActive:[!0,!1,!1],modulators:{vol:null,mod:null,pitch:null}}},props:["id"],mounted(){document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),window.addEventListener("resize",this.resizeGraphics),this.resizeGraphics(),this.gainNode=new m.S9,console.log(this.polyphonyVoices),this.synth=new B("",this.gainNode,this.polyphonyVoices),this.synth.setParameters({volume:(0,m.H2)(1-this.volume)}),this.synths.list.push(this.synth),this.id>1&&this.initConnections(),this.$emit("newOsc")},computed:{osc_container(){return{background:"#f8e7e6"}},type_button(){return{fontSize:".5vw",background:this.colors.pink.glow}},type_text(){return{color:this.colors.gray.dark}},volume_area(){return{background:this.colors.pink.dark}},mod_area(){return{background:this.colors.azure.medium}},pitch_area(){return{background:this.colors.green.glow}},mod_slider(){return{transform:"rotate(-"+111*this.modulation+"deg)",background:"white",opacity:"60%"}},volume_slider(){return{backgroundColor:"white",opacity:"60%",transform:"rotate("+112*this.volume+"deg)"}},pitch_slider(){return{background:this.colors.green.medium}},pitch_hand(){return{transform:"rotate("+50*this.pitch/this.maxPitch+"deg)",borderLeft:".1vw solid "+this.colors.green.dark}},osc_wave(){return{border:".1vw solid "+this.colors.green.dark,background:this.colors.green.glow}},lineL(){return{transform:"rotate(66deg)",borderLeft:".1vw solid "+this.colors.green.dark}},lineU(){return{transform:"rotate(-66deg)",borderLeft:".1vw solid "+this.colors.green.dark}},lineR(){return{transform:"rotate(180deg)",borderLeft:".1vw solid "+this.colors.green.dark}},chain_buttons(){return{background:this.colors.pink.glow}},button_1(){let e="";return e=this.isFilterChainRouteActive[0]?this.colors.purple.light:this.colors.pink.glow,{background:e,border:".1vw solid "+this.colors.gray.dark}},button_2(){let e="";return e=this.isFilterChainRouteActive[1]?this.colors.green.medium:this.colors.pink.glow,{background:e,border:".1vw solid "+this.colors.gray.dark}},button_3(){let e="";return e=this.isFilterChainRouteActive[2]?this.colors.pink.light:this.colors.pink.glow,{background:e,border:".1vw solid "+this.colors.gray.dark}}},methods:{handleDrop(e,t){if(null===this.modulators[t]){let s=JSON.parse(e.dataTransfer.getData("data"));"vol"===t&&"envelope"===s.type||(this.modulators[t]={color:s.color,id:s.id,type:s.type},document.dispatchEvent(new CustomEvent("link",{detail:{object:this.synth,target:t,color:this.color[t]["medium"],modulator:{type:this.modulators[t].type,id:this.modulators[t].id}}})))}},handleDragEnter(e){console.log("Dragging over "+e)},handleDragLeave(e){console.log("Dragging out of "+e)},unlinkMod(e){document.dispatchEvent(new CustomEvent("unLink",{detail:{object:this.synth,target:e,modulator:{type:this.modulators[e].type,id:this.modulators[e].id}}})),this.modulators[e]=null},computedModulation(e){switch(e){case"vol":return this.modulators[e]?{width:"1vw",height:"1vw",borderRadius:"50%",backgroundColor:this.modulators[e].color,position:"absolute",right:"0%"}:{display:"none",width:"0%",height:"0%"};case"mod":return this.modulators[e]?{width:"1vw",height:"1vw",borderRadius:"50%",backgroundColor:this.modulators[e].color,position:"absolute"}:{display:"none",width:"0%",height:"0%"};case"pitch":return this.modulators[e]?{width:"1vw",height:"1vw",borderRadius:"50%",backgroundColor:this.modulators[e].color,position:"absolute",left:"0%",bottom:"0%"}:{display:"none",width:"0%",height:"0%"}}},computedModText(e){return this.modulators[e]?this.modulators[e].id:""},dispose(){for(let e in this.modulators)this.modulators[e]&&this.unlinkMod(e);this.$emit("disposed",this.id),this.synth.disconnectDispose(),this.synths.list.splice(this.synths.list.indexOf(this.synth),1)},initConnections(){this.gainNode.connect(this.filterChains[0][0].getToneFilter())},resizeGraphics(){let e=document.body.clientWidth;this.wave_icon_size=e>=500?32*e/1500:0},onChainclick(e){try{this.isFilterChainRouteActive[e]?(console.log("disconnect from: "+this.filterChains[e][0]+" "+e),this.gainNode.disconnect(this.filterChains[e][0].getToneFilter())):(console.log("connect to: "+this.filterChains[e][0]+" "+e),this.gainNode.connect(this.filterChains[e][0].getToneFilter()))}catch(t){console.log("error: "+t+"\nCHAIN CONNECTION TO OSC UNSUCCESSFUL. Can't connect to "+this.filterChains[e][0])}this.isFilterChainRouteActive[e]=!this.isFilterChainRouteActive[e]},onMouseMove(e){this.is_volumeDown?(e.movementY<0?this.volume=Math.max(this.volume+e.movementY/100,0):this.volume=Math.min(this.volume+e.movementY/100,1),this.synth.setParameters({volume:(0,m.H2)(1-this.volume)})):this.is_modulationDown?(e.movementY<0?this.modulation=Math.max(this.modulation+e.movementY/100,0):this.modulation=Math.min(this.modulation+e.movementY/100,1),this.synth.setParameters({modulation:1-this.modulation})):this.is_pitchDown&&(e.movementX<0?this.pitch=Math.min(this.pitch-Math.floor(e.movementX),this.maxPitch):e.movementX>0&&(this.pitch=Math.max(this.pitch-Math.floor(e.movementX),this.minPitch)),this.synth.setParameters({transpose:this.pitch}))},onMouseUp(e){this.is_modulationDown&&(this.is_modulationDown=!1),this.is_volumeDown&&(this.is_volumeDown=!1),this.is_pitchDown&&(this.is_pitchDown=!1)},modulationDown(e){this.is_modulationDown||(this.is_modulationDown=!0)},volumeDown(e){this.is_volumeDown||(this.is_volumeDown=!0)},pitchDown(e){this.is_pitchDown||(this.is_pitchDown=!0)},nextOscType(){this.oscTypeIndex++,this.oscTypeIndex>=J.length&&(this.oscTypeIndex=0),this.synth.setParameters({type:J[this.oscTypeIndex]})},nextWaveform(){this.oscWaveIndex++,this.oscWaveIndex>=Z.length&&(this.oscWaveIndex=0),this.synth.setParameters({waveform:Z[this.oscWaveIndex]})},connect(e){this.synth.connect(e)}},unmounted(){window.removeEventListener("resize",this.resizeGraphics),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}};const ee=(0,l.Z)(Q,[["render",A],["__scopeId","data-v-a2d87af4"]]);var te=ee,se={components:{Osc:te},data(){return{oscList:[],name:"oscHost",i:0}},mounted(){this.addOsc(),this.addOsc()},methods:{handleNewOsc(){this.$emit("newOsc")},initConnections(){for(let e in this.$refs)(0,X.IU)(this.$refs[e][0]).initConnections()},addOsc(){let e="osc"+this.i;this.oscList.push({id:this.i,ref:e}),this.i+=1},removeOsc(e){let t=0;this.oscList.forEach((s=>{s.id===e&&(t=this.oscList.indexOf(s))})),this.oscList.splice(t,1)}},unmounted(){},computed:{oscHost(){return{background:"#f8e7e6"}},voidBorder(){return{background:this.colors.pink.glow,border:".1vw solid"+this.colors.pink.dark}}}};const oe=(0,l.Z)(se,[["render",M],["__scopeId","data-v-822b82c8"]]);var ie=oe;function ne(e,t,s,o,n,a){const r=(0,i.up)("FilterChain");return(0,i.wg)(),(0,i.iD)("div",{class:"filterHost",style:(0,f.j5)(this.filterHost)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.chainList,(e=>((0,i.wg)(),(0,i.j4)(r,{key:e.id,ref_for:!0,ref:e.ref,id:e.id,color:e.color,onFilterInitialized:t[0]||(t[0]=e=>a.initConnections())},null,8,["id","color"])))),128))],4)}const ae=e=>((0,i.dD)("data-v-b8ee23ec"),e=e(),(0,i.Cn)(),e),re={class:"filterChain"},le={class:"chainHead",ref:"chainHead"},he={class:"chainTail"},ce=ae((()=>(0,i._)("div",null,null,-1))),de=ae((()=>(0,i._)("div",null,null,-1)));function ue(e,t,s,o,n,a){const r=(0,i.up)("Filter");return(0,i.wg)(),(0,i.iD)("div",re,[(0,i._)("div",{class:"chainline",style:(0,f.j5)(this.chainLine)},null,4),(0,i._)("div",{class:"chainDot",style:(0,f.j5)(this.chainDot)},null,4),(0,i._)("div",le,null,512),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.filterList,(e=>((0,i.wg)(),(0,i.j4)(r,{key:e.id,ref_for:!0,ref:e.ref,chainId:this.id,id:e.id,filter_type:e.type,chainColor:this.color,onFiltersMounted:t[0]||(t[0]=e=>this.handleFiltersMounted())},null,8,["chainId","id","filter_type","chainColor"])))),128)),(0,i._)("div",he,[ce,(0,i._)("div",{class:"routing-btn fx_chain_1",style:(0,f.j5)(a.fx_chain_1),onClick:t[1]||(t[1]=e=>a.setRouting(0))},null,4),(0,i._)("div",{class:"routing-btn fx_chain_2",style:(0,f.j5)(a.fx_chain_2),onClick:t[2]||(t[2]=e=>a.setRouting(1))},null,4),(0,i._)("div",{class:"routing-btn fx_chain_3",style:(0,f.j5)(a.fx_chain_3),onClick:t[3]||(t[3]=e=>a.setRouting(2))},null,4),de])])}const pe={class:"filter"},me=["textContent"],fe={class:"filter_back",ref:"filter_back"},ve={key:0,class:"logo_text"},ge={key:1,class:"logo_text"},ye={key:3,class:"logo_BD_back"};function we(e,t,s,n,a,r){return(0,i.wg)(),(0,i.iD)("div",pe,[(0,i._)("div",{class:"modDot",style:(0,f.j5)(r.computedModulation("filter")),onClick:t[0]||(t[0]=(0,o.iM)((e=>r.unlinkMod("filter")),["shift","stop"])),textContent:(0,f.zw)(r.computedModText("filter"))},null,12,me),(0,i._)("div",fe,null,512),(0,i._)("div",{class:"filter_logo",style:(0,f.j5)(this.filter_logo),onMousedown:t[6]||(t[6]=(...e)=>r.logoDown&&r.logoDown(...e))},[a.is_logoDown&&"peaking"!=a.type?((0,i.wg)(),(0,i.iD)("div",ve,(0,f.zw)((100*(1-this.resonance)).toFixed()+"%"),1)):(0,i.kq)("",!0),a.is_logoDown&&"peaking"==a.type?((0,i.wg)(),(0,i.iD)("div",ge,(0,f.zw)((100*(1-2*this.resonance)).toFixed()+"%"),1)):(0,i.kq)("",!0),(0,i._)("div",{class:"logo_glow",style:(0,f.j5)(r.computedGlow)},null,4),(0,i._)("div",{class:"logo_border",onDragenter:[t[1]||(t[1]=e=>r.handleDragEnter("filter")),t[3]||(t[3]=(0,o.iM)((()=>{}),["prevent"]))],onDragleave:t[2]||(t[2]=e=>r.handleDragLeave("filter")),onDragover:t[4]||(t[4]=(0,o.iM)((()=>{}),["prevent"])),onDrop:t[5]||(t[5]=e=>r.handleDrop(e,"filter"))},null,32),(0,i._)("div",{class:"logo",style:(0,f.j5)(r.logo)},[a.is_logoDown?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"logo_text_back",style:(0,f.j5)(this.logo_text_back)},null,4)):(0,i.kq)("",!0),"lowpass"===a.type?((0,i.wg)(),(0,i.iD)("div",{key:1,class:"logo_LP",style:(0,f.j5)(r.computedLP)},null,4)):(0,i.kq)("",!0),"highpass"===a.type?((0,i.wg)(),(0,i.iD)("div",{key:2,class:"logo_HP",style:(0,f.j5)(r.computedHP)},null,4)):(0,i.kq)("",!0),"peaking"===a.type?((0,i.wg)(),(0,i.iD)("div",ye)):(0,i.kq)("",!0),"peaking"===a.type?((0,i.wg)(),(0,i.iD)("div",{key:4,class:"logo_BD_circle",style:(0,f.j5)(r.computedBDCircle)},null,4)):(0,i.kq)("",!0)],4)],36)])}class be{constructor(e="peaking",t=.5,s=.5){this.filter_type=e,this.cutoff=t,this.resonance=s,this.modulatorsData={envelope:{amount:0,parameters:{attack:1,decay:.3,sustain:.8,release:1}},lfo:{amount:0,parameters:{frequency:10,waveform:"sine",min:0,max:1}}},this.activeNotes=0,this.modulators={envelope:{signal:this.createModulator("envelope"),scale:new m.db(0,1,3),amount:0},lfo:{signal:this.createModulator("lfo"),scale:new m.db(0,1,3),amount:0}},this.filter=new m.wn,this.initFilterParams()}getCutoff(){return this.cutoff}getResonance(){return this.resonance}createModulator(e){switch(e){case"envelope":return new m.wr;case"lfo":return new m.Fo;default:return console.log("Error creating modulator"),null}}initFilterParams(){let e=this;switch(this.filter_type){case"lowpass":this.cutoff=.9,this.resonance=1;break;case"highpass":this.cutoff=.1,this.resonance=1;break;case"peaking":this.cutoff=.5,this.resonance=.5;break;case"bandpass":break;case"lowshelf":break;case"highshelf":break;case"notch":break;case"allpass":break;default:console.log("Invalid filter type")}this.filter.set({frequency:e.cutoffLogMapping(this.cutoff),type:this.filter_type}),this.scaleSetter(this.modulators.envelope),this.scaleSetter(this.modulators.lfo),this.connectModulator(this.modulators.envelope),this.connectModulator(this.modulators.lfo),this.updateModulators()}scaleSetter(e,t=""){(0,X.IU)(e.scale).set({min:Math.pow(10,Math.log10(this.cutoffLogMapping(this.cutoff))-1*e.amount),max:Math.pow(10,Math.log10(this.cutoffLogMapping(this.cutoff))+1*e.amount)})}connectModulator(e){e.signal.chain(e.scale,this.filter.frequency)}setModulatorParameters(e,t,s){this.modulatorsData[e].parameters=s,this.updateModulators()}setModulatorAmount(e,t,s){this.modulatorsData[e].amount=s,this.updateModulators()}updateModulators(){for(let e in this.modulators)this.modulators[e].amount=this.modulatorsData[e].amount,this.scaleSetter(this.modulators[e]),this.modulatorSetter((0,X.IU)(this.modulators[e].signal),e,this.modulatorsData[e].parameters)}modulatorSetter(e,t,s){switch((0,X.IU)(s).waveform||((0,X.IU)(s).waveform=e.type),t){case"envelope":e.set({attack:s.attack,decay:s.decay,sustain:s.sustain,release:s.release+.001});break;case"lfo":e.set({type:(0,X.IU)(s).waveform,frequency:(0,X.IU)(s).frequency});break;default:console.log("Error setting modulator parameters, invalid args");break}}playNote(e="",t=""){this.modulators.envelope.signal.cancel(m.zO()),this.modulators.envelope.signal.triggerAttack(m.zO()),this.modulators.lfo.signal.stop(),this.modulators.lfo.signal.start(),this.activeNotes++}stopNote(e=""){this.activeNotes<=1&&this.modulators.envelope.signal.triggerRelease(m.zO()),this.activeNotes--}setCutoff(e=this.cutoff){this.cutoff=e;let t=this;this.filter.set({frequency:t.cutoffLogMapping(this.cutoff)}),this.updateModulators()}setResonance(e=this.resonance){this.resonance=e;let t=this;"lowshelf"===this.filter_type||"highshelf"===this.filter_type||"peaking"===this.filter_type?this.filter.set({gain:t.resonanceRangeNormalizer(1-t.resonance,this.filter_type)}):"lowpass"!==this.filter_type&&"highpass"!==this.filter_type||this.filter.set({Q:t.resonanceRangeNormalizer(1-t.resonance,this.filter_type)})}connect(e){try{this.filter.connect(e)}catch(t){console.log("ERROR: "+t+" - myfilter: ",this.filter," -connect to destination: ",e)}}disconnect(e){this.filter.disconnect(e)}getToneFilter(){return this.filter}cutoffLogMapping(e){if(!(e<0||e>1))return 20*Math.pow(10,Math.log10(1100)*e);console.error("Input value must be between 0 and 1.")}resonanceRangeNormalizer(e,t){if(e<0||e>1)console.error("Input value must be between 0 and 1.");else switch(t){case"lowpass":return 15*e;case"highpass":return 15*e;case"peaking":return 30*(e-.5);default:break}}}var ke={props:["filter_type","chainId","chainColor","id"],data(){return{color:this.colors.yellow,type:this.filter_type,cutoff:.5,resonance:.5,is_logoDown:!1,modulator:null}},mounted(){document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),this.filter=new be(this.type,this.cutoff,this.resonance),this.cutoff=this.filter.getCutoff(),this.resonance=this.filter.getResonance(),this.filterChains[this.chainId][this.id]=this.filter,this.id===this.nFiltersXchain-1&&this.chainId===this.nFilterChains-1&&this.$emit("filtersMounted")},methods:{handleDrop(e,t=""){if(null===this.modulator){let s=JSON.parse(e.dataTransfer.getData("data"));this.modulator={color:s.color,id:s.id,type:s.type},document.dispatchEvent(new CustomEvent("link",{detail:{object:this.filter,target:t,color:this.color["light"],modulator:{type:this.modulator.type,id:this.modulator.id}}}))}},handleDragEnter(e){console.log("Dragging over "+e)},handleDragLeave(e){console.log("Dragging out of "+e)},unlinkMod(e){document.dispatchEvent(new CustomEvent("unLink",{detail:{object:this.filter,target:e,modulator:{type:this.modulator.type,id:this.modulator.id}}})),this.modulator=null},computedModulation(e=""){return this.modulator?{width:"1vw",height:"1vw",borderRadius:"50%",backgroundColor:this.modulator.color,position:"absolute",left:"10%",zIndex:"1",top:"10%"}:{display:"none",width:"0%",height:"0%"}},computedModText(e=""){return this.modulator?this.modulator.id:""},onMouseMove(e){this.is_logoDown&&(e.movementY<0?this.resonance=Math.max(this.resonance+e.movementY/100,0):this.resonance=Math.min(this.resonance+e.movementY/100,1),e.movementX<0?this.cutoff=Math.max(this.cutoff+Math.floor(e.movementX)/100,0):e.movementX>0&&(this.cutoff=Math.min(this.cutoff+Math.floor(e.movementX)/100,1)),this.filter.setResonance(this.resonance),this.filter.setCutoff(this.cutoff))},onMouseUp(){this.is_logoDown&&(this.is_logoDown=!1),document.body.style.cursor="pointer"},logoDown(){this.is_logoDown||(this.is_logoDown=!0,document.body.style.cursor="none")},setCutoff(e=this.cutoff){this.cutoff=e,this.filter.setCutoff(this.cutoff)},setResonance(e=this.resonance){this.resonance=e,this.filter.setResonance(this.resonance)},connect(e){this.filter.connect(e)},disconnect(e){this.filter.disconnect(e)},getToneFilter(){return this.filter.getToneFilter()},getMyFilter(){return this.filter}},computed:{computedHeadStyle(){return{left:.7*this.cutoff*100+13.5+"%"}},computedGlow(){return"peaking"===this.filter_type&&this.resonance<.5?{opacity:1-2*this.resonance,background:this.colors.yellow.light}:"peaking"===this.filter_type&&this.resonance>=.5?{opacity:2*this.resonance-1,background:this.colors.yellow.light}:{opacity:1-this.resonance,background:this.colors.yellow.light}},computedLP(){return{transform:"translateX("+(100*this.cutoff-100)+"%)"}},computedHP(){return{transform:"translateX("+100*this.cutoff+"%)"}},computedBDMaks(){let e="";return e=this.resonance>.5?"polygon(0% 0%, 100% 0%, 100% 50%, 0% 50%)":this.resonance<.5?"polygon(0% 50%, 0% 100%, 100% 100%, 100% 50%)":"polygon(0% 0%, 100% 0%, 100% 50%, 0% 50%)",{clipPath:e}},computedBD(){return 1-this.resonance>=.5?{height:100*(1-this.resonance)+"%",transform:"translateX("+100*this.cutoff+"%)"}:{height:100*(1-this.resonance-.5)+"%",transform:"translateX("+100*(this.cutoff-.5)+"%)"}},computedBDCircle(){return{transform:"translate("+100*(this.cutoff-.5)+"%, "+100*(this.resonance-.5)+"%)"}},filter_logo(){return{background:this.colors.yellow.glow}},logo(){return{background:this.colors.yellow.light}},logo_text_back(){return{background:this.colors.yellow.light}}}};const _e=(0,l.Z)(ke,[["render",we],["__scopeId","data-v-48ffc09b"]]);var De=_e;const Me=["highpass","peaking","lowpass"];var Ce={ref:"FilterChain",components:{Filter:De},props:["color","id"],data(){return{filterList:[],nFilters:3,isFxChainRouteActive:[!0,!1,!1]}},mounted(){for(let e=0;e<this.nFiltersXchain;e++)this.filterList.push({id:e,ref:"filter"+e,type:Me[e]})},computed:{fx_chain_1(){let e="";return e=this.isFxChainRouteActive[0]?this.colors.purple.light:this.colors.yellow.glow,{background:e,border:".1vw solid"+this.colors.gray.dark}},fx_chain_2(){let e="";return e=this.isFxChainRouteActive[1]?this.colors.green.medium:this.colors.yellow.glow,{background:e,border:".1vw solid"+this.colors.gray.dark}},fx_chain_3(){let e="";return e=this.isFxChainRouteActive[2]?this.colors.pink.light:this.colors.yellow.glow,{background:e,border:".1vw solid"+this.colors.gray.dark}},chainLine(){return{top:"49%",left:"5%",width:"88%",height:".2vw",position:"absolute",background:this.$props["color"],zIndex:"0",borderRadius:"10%"}},chainDot(){return{top:"45%",left:"3.5%",height:"10%",aspectRatio:"1/1",position:"absolute",zIndex:"3",background:this.$props["color"],borderRadius:"50%"}}},methods:{handleFiltersMounted(){this.id===this.nFilterChains-1&&this.$emit("filterInitialized")},initConnections(){for(let e=0;e<this.nFiltersXchain-1;e++)this.filterChains[this.id][e].connect(this.filterChains[this.id][e+1].getToneFilter());this.filterChains[this.id][this.nFilters-1].connect(this.fxChains[0][0]),this.isFxChainRouteActive[0]=!0},setRouting(e){console.log("chain click - id: "+e);try{this.isFxChainRouteActive[e]?(console.log("disconnect from: "+this.fxChains[e][0]+" "+e),this.filterChains[this.id][this.nFilters-1].disconnect(this.fxChains[e][0])):(console.log("connect to: "+this.fxChains[e][0]+" "+e),this.filterChains[this.id][this.nFilters-1].connect(this.fxChains[e][0]))}catch(t){console.log("error: "+t+"\nCHAIN FILTERS CONNECTION TO FX CHAIN "+e+" UNSUCCESSFUL. Can't connect to "+this.fxChains[e][0])}this.isFxChainRouteActive[e]=!this.isFxChainRouteActive[e]}}};const xe=(0,l.Z)(Ce,[["render",ue],["__scopeId","data-v-b8ee23ec"]]);var Ie=xe,Le={name:"FilterHost",components:{FilterChain:Ie},data(){return{chain_colors:[],chainList:[],nFilterChains:3}},mounted(){this.chain_colors=[this.colors.purple.medium,this.colors.green.medium,this.colors.pink.medium];for(let e=0;e<this.nFilterChains;e++)this.chainList.push({id:e,ref:"chain"+e,color:this.chain_colors[e]})},computed:{filterHost(){return{background:this.colors.yellow.glow}}},methods:{initConnections(){for(let e in this.$refs)(0,X.IU)(this.$refs[e][0]).initConnections();this.$emit("filterInitialized")}}};const Fe=(0,l.Z)(Le,[["render",ne],["__scopeId","data-v-2c1963ee"]]);var Ue=Fe;const je={class:"chainHeadsRow"},Oe={class:"fxGrid"};function $e(e,t,s,o,n,a){const r=(0,i.up)("FxCell");return(0,i.wg)(),(0,i.iD)("div",{style:(0,f.j5)(this.fxBack)},[(0,i._)("div",{class:"fxHost",style:(0,f.j5)(this.fxHost)},[(0,i._)("div",je,[(0,i._)("div",{class:"chainHead",style:(0,f.j5)(this.chainHead1)},null,4),(0,i._)("div",{class:"chainHead",style:(0,f.j5)(this.chainHead2)},null,4),(0,i._)("div",{class:"chainHead",style:(0,f.j5)(this.chainHead3)},null,4)]),(0,i._)("div",Oe,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.Fx_chain1,(e=>((0,i.wg)(),(0,i.j4)(r,{ref_for:!0,ref:"effects",chainId:e.chainId,id:e.id,item:e},null,8,["chainId","id","item"])))),256)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.Fx_chain2,(e=>((0,i.wg)(),(0,i.j4)(r,{chainId:e.chainId,id:e.id,item:e},null,8,["chainId","id","item"])))),256)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.Fx_chain3,(e=>((0,i.wg)(),(0,i.j4)(r,{chainId:e.chainId,id:e.id,item:e,onFxMounted:t[0]||(t[0]=e=>this.initFxConnections())},null,8,["chainId","id","item"])))),256))]),(0,i._)("div",{class:"gainList",style:(0,f.j5)(this.gainList)},[(0,i._)("div",{id:"gain1",class:"channelGain",style:(0,f.j5)(a.channelGain(0)),onMousedown:t[1]||(t[1]=e=>a.gainMouseDown(0))},[(0,i._)("div",{class:"channelGainFader",style:(0,f.j5)(a.computedFxGainKnobStyle(0))},null,4)],36),(0,i._)("div",{id:"gain2",class:"channelGain",style:(0,f.j5)(a.channelGain(1)),onMousedown:t[2]||(t[2]=e=>a.gainMouseDown(1))},[(0,i._)("div",{class:"channelGainFader",style:(0,f.j5)(a.computedFxGainKnobStyle(1))},null,4)],36),(0,i._)("div",{id:"gain3",class:"channelGain",style:(0,f.j5)(a.channelGain(2)),onMousedown:t[3]||(t[3]=e=>a.gainMouseDown(2))},[(0,i._)("div",{class:"channelGainFader",style:(0,f.j5)(a.computedFxGainKnobStyle(2))},null,4)],36)],4)],4)],4)}var Pe=s.p+"img/blizzard.23000ce3.svg",Ee=s.p+"img/drop.7b7c4620.svg",Ne=s.p+"img/fire.b4dfdadb.svg",Te=s.p+"img/moon.30640c34.svg",ze=s.p+"img/wind.5ef8dfcc.svg",Re=s.p+"img/tornado.ee5aa595.svg";const Se={class:"icon"},He={key:1,src:Pe,alt:""},qe={key:2,src:Ee,alt:""},Ae={key:3,src:Ne,alt:""},Ke={key:4,src:Te,alt:""},Ve={key:5,src:ze,alt:""},Ge={key:6,src:Re,alt:""};function We(e,t,s,n,a,r){return(0,i.wg)(),(0,i.iD)("div",{class:"cell",onClick:[t[3]||(t[3]=(...e)=>r.nextFx&&r.nextFx(...e)),t[4]||(t[4]=(0,o.iM)(((...e)=>r.setToBypass&&r.setToBypass(...e)),["shift"]))],onMousedown:t[5]||(t[5]=(...e)=>r.fxDown&&r.fxDown(...e))},[(0,i._)("div",Se,[0===this.typeId?((0,i.wg)(),(0,i.iD)("div",{key:0,ref:"plus",style:(0,f.j5)(this.iconDiv),onMouseover:t[0]||(t[0]=(...e)=>this.onIconEnter&&this.onIconEnter(...e)),onMouseout:t[1]||(t[1]=(...e)=>r.onIconLeave&&r.onIconLeave(...e))}," +",36)):(0,i.kq)("",!0),1===this.typeId?((0,i.wg)(),(0,i.iD)("img",He)):(0,i.kq)("",!0),2===this.typeId?((0,i.wg)(),(0,i.iD)("img",qe)):(0,i.kq)("",!0),3===this.typeId?((0,i.wg)(),(0,i.iD)("img",Ae)):(0,i.kq)("",!0),4===this.typeId?((0,i.wg)(),(0,i.iD)("img",Ke)):(0,i.kq)("",!0),5===this.typeId?((0,i.wg)(),(0,i.iD)("img",Ve)):(0,i.kq)("",!0),6===this.typeId?((0,i.wg)(),(0,i.iD)("img",Ge)):(0,i.kq)("",!0)]),(0,i._)("div",{class:"glow",style:(0,f.j5)(r.computedGlowStyle),onMousedown:t[2]||(t[2]=(...e)=>r.fxDown&&r.fxDown(...e))},null,36)],32)}class Xe{constructor({type:e="none",modulation:t=0}){this.type=e,this.mod=t,this.effect=this.generateToneFx(e),this.modulatorsPreset={envelope:{mod:{amount:0,signal:null}},lfo:{mod:{amount:0,signal:null}}}}getToneReference(){return this.effect}generateToneFx(e){let t;switch(e){case 0:case"none":t=new m.S9;break;case 1:case"reverb":t=this.createReverb();break;case 2:case"delay":t=this.createDelay();break;case 3:case"distortion":t=this.createDistortion();break;case 4:case"vibrato":t=this.createVibrato();break;case 5:case"pan":t=this.createPan();break;case 6:case"chorus":t=this.createChorus();break;default:t=new m.S9}return this.setFxParams({effect:t,type:e}),t}setFxParams({effect:e=this.effect,type:t=this.type,mod:s=this.mod}){switch(this.effect=e,this.type=t,this.mod=s,t){case 1:case"reverb":this.effect.set({decay:.1+5*s,wet:.3+.7*s});break;case 2:case"delay":this.effect.set({delayTime:.05+.4*s,feedback:.05+.9*s,wet:.3+.7*s});break;case 3:case"distortion":this.effect.set({distortion:.05+.95*s,wet:.4+.6*s});break;case 4:case"vibrato":this.effect.set({depth:.5+.5*s,frequency:1+20*s,wet:.5+.5*s});break;case 5:case"pan":let e=2*s-1;this.effect.set({pan:e,wet:1}),console.log("pan coeff: "+e.toFixed(2));break;case 6:case"chorus":this.effect.set({depth:.6+.4*s,frequency:30+10*s,spread:80*s*8,wet:1,feedback:.05+.9*s,type:"triangle"+(10*s).toFixed(0).toString(),delayTime:100+90*s});break;default:this.effect=new m.S9}}createReverb(){return new m.E8}createDelay(){return new m.D0}createDistortion(){return new m.df}createVibrato(){return new m.Z7}createPan(){return new m.fL}createChorus(){return new m.bK}createModulator(e){switch(e){case"envelope":return new m.wr;case"lfo":return new m.Fo;default:return console.log("Error creating modulator"),null}}modulatorSetter(e,t,s){switch(t){case"envelope":e.set({attack:s.attack,decay:s.decay,sustain:s.sustain,release:s.release});break;case"lfo":e.set({});break;default:console.log("Error setting modulator parameters, invalid args");break}}setModulatorParameters(e,t,s){this.initialized&&(this.modulatorsData[e][t].parameters=s,this.updateModulators())}connectModulator(e,t,s,o){switch(t){case"envelope":break;case"lfo":break;default:console.log("invalid modulator type");break}}connect(e){this.effect.connect(e)}disconnect(){this.effect.disconnect()}dispose(){this.effect.dispose()}}const Ye=["none","reverb","delay","distortion","vibrato","pan","chorus"],Be=["transparent","lightblue","deepskyblue","red","orange","darkorchid","yellow"];var Ze={props:["chainId","id","ref"],data(){return{modulation:0,is_down:!1,typeId:0,volume:0,startX:0,startY:0,endX:0,endY:0,threshold:2}},mounted(){document.addEventListener("mouseup",this.onMouseup),document.addEventListener("mousemove",this.onMousemove),this.effect=new Xe({typeId:Ye[this.typeId],modulation:this.modulation}),this.fxChains[this.chainId][this.id]=this.effect,this.chainId===this.nFxChains-1&&this.id===this.nFxXchain&&this.$emit("fxMounted")},computed:{computedGlowStyle(){return{opacity:100*(this.modulation+.3)+"%",background:Be[this.typeId]}},iconDiv(){let e="black";return 0===this.chainId&&(e=this.colors.purple.medium),1===this.chainId&&(e=this.colors.green.medium),2===this.chainId&&(e=this.colors.pink.medium),{color:e}},iconDivBlack(){let e="black";return{color:e}},onIconEnter(){this.$refs["plus"].style.color="black"},onIconLeave(){let e="black";0===this.chainId&&(e=this.colors.purple.medium),1===this.chainId&&(e=this.colors.green.medium),2===this.chainId&&(e=this.colors.pink.medium),this.$refs["plus"].style.color=e}},components:{isSVGTag:f.aN},methods:{nextFx(){const e=Math.sqrt(Math.pow(this.endX-this.startX,2)+Math.pow(this.endY-this.startY,2));if(e<=this.threshold&&!this.is_down){this.typeId=this.generateNextTypeIndex();let e=Ye[this.typeId];console.log(e),this.changeFxType(e)}},changeFxType(e){this.effect.disconnect(),this.effect.dispose(),this.effect=new Xe({type:e,modulation:this.modulation}),this.effect.setFxParams({type:e,mod:this.modulation}),this.fxChains[this.chainId][this.id]=this.effect,this.fxChains[this.chainId][this.id-1].connect(this.fxChains[this.chainId][this.id].getToneReference()),this.fxChains[this.chainId][this.id+1]instanceof Xe?this.fxChains[this.chainId][this.id].connect(this.fxChains[this.chainId][this.id+1].getToneReference()):this.fxChains[this.chainId][this.id+1]instanceof m.S9&&this.fxChains[this.chainId][this.id].connect(this.fxChains[this.chainId][this.id+1])},generateRandomTypeIndex(){return Math.round(10*Math.random()+1)%Ye.length},generateNextTypeIndex(){return(this.typeId+1)%Ye.length},setToBypass(){this.typeId=0,this.changeFxType("none"),console.log("set fx in position "+this.chainId+" - "+this.id+" to bypass")},fxDown(e){this.startX=e.clientX,this.startY=e.clientY,this.is_down||(this.is_down=!0)},onMouseup(e){this.endX=e.clientX,this.endY=e.clientY,this.is_down&&(this.is_down=!1)},onMousemove(e){this.is_down&&(e.movementY<0?this.modulation=Math.min(this.modulation-e.movementY/100,1):this.modulation=Math.max(this.modulation-e.movementY/100,0),this.effect.setFxParams({fx:this.effect,typeId:this.typeId,mod:this.modulation}))}}};const Je=(0,l.Z)(Ze,[["render",We],["__scopeId","data-v-63415296"]]);var Qe=Je,et={name:"FxHost",components:{FxCell:Qe},data(){return{Fx_chain1:[],Fx_chain2:[],Fx_chain3:[],isGainSelected:"",chainsGains:""}},mounted(){this.isGainSelected=Array(this.nFxChains).fill(!1),this.chainsGains=Array(this.nFxChains).fill(0),this.chainsGains[0]=.8,this.chainsGains[1]=.8,this.chainsGains[2]=.8;for(let e=1;e<=this.nFxXchain;e++)this.Fx_chain1.push({id:e,ref:"Fx"+e,chainId:0}),this.Fx_chain2.push({id:e,ref:"Fx"+e+this.nFxXchain,chainId:1}),this.Fx_chain3.push({id:e,ref:"Fx"+e+2*this.nFxXchain,chainId:2});for(let e=0;e<this.nFxChains;e++)this.fxChains[e][0]=new m.S9(1),this.fxChains[e][this.nNodesXfxChain-1]=new m.S9(+this.chainsGains[e])},methods:{initFxConnections(){for(let e=0;e<this.nFxChains;e++){for(let t=0;t<this.nNodesXfxChain-2;t++)this.fxChains[e][t].connect(this.fxChains[e][t+1].getToneReference());this.fxChains[e][this.nNodesXfxChain-2].connect(this.fxChains[e][this.nNodesXfxChain-1]),this.fxChains[e][this.nNodesXfxChain-1].connect((0,m.Y3)())}},setChainVolume(e,t){this.fxChains[e][this.nNodesXfxChain-1].gain=t},gainMouseDown(e){this.isGainSelected[e]=!0},handleMouseUp(e){this.isGainSelected.fill(!1)},handleMouseMove(e){this.isGainSelected.forEach(((t,s)=>{t&&(this.chainsGains[s]=this.chainsGains[s]-Math.floor(e.movementY)/100,this.chainsGains[s]=Math.max(this.chainsGains[s],0),this.chainsGains[s]=Math.min(this.chainsGains[s],1),this.fxChains[s][this.nNodesXfxChain-1].set({gain:this.chainsGains[s]}))}))},computedFxGainKnobStyle(e){let t="";return 0===e&&(t=this.colors.purple.medium),1===e&&(t=this.colors.green.medium),2===e&&(t=this.colors.pink.medium),{height:100*this.chainsGains[e]+"%",top:50*(1-this.chainsGains[e])+"%",left:50*(1-this.chainsGains[e])+"%",background:t}},channelGain(e){let t="";return 0==e&&(t=this.colors.purple.glow),1==e&&(t=this.colors.green.glow),2==e&&(t=this.colors.pink.glow),{background:t}}},computed:{fxHost(){return{background:this.colors.orange.glow,border:".1vw solid "+this.colors.orange.dark,boxSizing:"border-box"}},gainList(){return{background:this.colors.orange.light,borderTop:".1vw solid "+this.colors.orange.dark,boxSizing:"border-box",height:"100%"}},chainHead1(){return{background:this.colors.purple.light}},chainHead2(){return{background:this.colors.green.medium}},chainHead3(){return{background:this.colors.pink.light}},fxBack(){return{position:"relative",height:"100%",width:"100%",background:this.colors.orange.light}}}};const tt=(0,l.Z)(et,[["render",$e],["__scopeId","data-v-1dd12caa"]]);var st=tt;function ot(e,t,s,o,n,a){const r=(0,i.up)("SpecAnalyzer"),l=(0,i.up)("Oscilloscope"),h=(0,i.up)("Meter");return(0,i.wg)(),(0,i.iD)("div",{class:"toolsHost",style:(0,f.j5)(this.toolsHost)},[(0,i.Wm)(r),(0,i.Wm)(l,{ref:"oscilloscope"},null,512),(0,i.Wm)(h)],4)}const it=e=>((0,i.dD)("data-v-c5d289ba"),e=e(),(0,i.Cn)(),e),nt={class:"signalSum"},at=it((()=>(0,i._)("div",null,null,-1)));function rt(e,t,s,o,n,a){return(0,i.wg)(),(0,i.iD)("div",{class:"meter",style:(0,f.j5)(this.Meter)},[(0,i._)("div",nt,[(0,i._)("div",{ref:"left",class:"signal",style:(0,f.j5)(a.computedWidthLeft)},null,4),at,(0,i._)("div",{ref:"right",class:"signal",style:(0,f.j5)(a.computedWidthRight)},null,4)])],4)}var lt={data(){return{widthLeft:0,widthRight:0}},computed:{computedWidthLeft(){return{width:`${this.widthLeft}%`,background:this.colors.green.medium}},computedWidthRight(){return{width:`${this.widthRight}%`,background:this.colors.green.medium}},Meter(){return{background:this.colors.green.glow}}},mounted(){this.meter=new m.Yu({channels:2}),m.Y3().connect(this.meter),this.intervalId=setInterval((()=>{this.updateWidths()}),25)},methods:{updateWidths(){[this.leftVolume,this.rightVolume]=this.meter.getValue(),(isFinite(this.leftVolume)||isFinite(this.rightVolume))&&(this.widthLeft=Math.min(100*(0,m.xz)(this.leftVolume),100),this.widthRight=Math.min(100*(0,m.xz)(this.rightVolume),100))}},beforeDestroy(){this.meter.stop(),this.meter.dispose(),clearInterval(this.intervalId)}};const ht=(0,l.Z)(lt,[["render",rt],["__scopeId","data-v-c5d289ba"]]);var ct=ht;const dt={class:"oscilloscope"};function ut(e,t,s,o,n,a){return(0,i.wg)(),(0,i.iD)("div",dt,[(0,i._)("canvas",{ref:"canvas",class:"oscilloscopeCanvas",style:(0,f.j5)(this.oscilloscopeCanvas)},null,4)])}var pt={data(){return{oscilloscopeData:[],timing:10}},mounted(){this.oscilloscope=new m.uc,m.Y3().connect(this.oscilloscope),this.startOscilloscope(),this.canvas=this.$refs.canvas,this.canvas.width=4*this.canvas.offsetWidth,this.canvas.height=4*this.canvas.offsetHeight,this.ctx=this.canvas.getContext("2d")},methods:{setTiming(e){this.timing=e,clearInterval(this.intervalId),this.startOscilloscope()},startOscilloscope(){this.intervalId=setInterval((()=>{this.updateOscilloscopeData()}),this.timing)},draw(e){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="#658060",this.ctx.lineWidth=6,this.ctx.beginPath();for(let t=0;t<e.length;t++){let s=t*(this.canvas.width/e.length),o=this.canvas.height/2*(1-e[t]);this.ctx.moveTo(s,o),this.ctx.lineTo(s+this.canvas.width/e.length,o)}this.ctx.stroke(),this.ctx.moveTo(0,0)},updateOscilloscopeData(){this.oscilloscopeData=this.oscilloscope.getValue(),this.draw(this.oscilloscopeData)}},computed:{oscilloscopeCanvas(){return{background:this.colors.green.glow}}},beforeDestroy(){this.oscilloscope.dispose()}};const mt=(0,l.Z)(pt,[["render",ut]]);var ft=mt;const vt={class:"spectral-analyzer"};function gt(e,t,s,o,n,a){return(0,i.wg)(),(0,i.iD)("div",vt,[(0,i._)("canvas",{class:"analyzerCanvas",ref:"canvas",style:(0,f.j5)(this.analyzerCanvas)},null,4)])}var yt={data(){return{timing:10}},mounted(){this.analyser=new m.qk("fft",2048),this.canvasCtx=this.$refs.canvas.getContext("2d"),m.Y3().connect(this.analyser),this.startAnalyzer()},methods:{draw(){let e;this.data=this.analyser.getValue(),this.canvasCtx.strokeStyle="#658060",this.canvasCtx.clearRect(0,0,this.$refs.canvas.width,this.$refs.canvas.height);for(let t=0;t<this.data.length;t++)this.value=6*(0,m.xz)(this.data[t])*this.$refs.canvas.height,e=Math.log10(t)/Math.log10(2048)*this.$refs.canvas.width,this.canvasCtx.fillStyle="black",this.canvasCtx.fillRect(e,this.$refs.canvas.height-this.value,1,this.value)},startAnalyzer(){this.intervalId=setInterval((()=>{this.draw()}),10)}},computed:{analyzerCanvas(){return{background:this.colors.green.glow}}},beforeDestroy(){}};const wt=(0,l.Z)(yt,[["render",gt]]);var bt=wt,kt={name:"ToolsHost",components:{Meter:ct,Oscilloscope:ft,SpecAnalyzer:bt},data(){return{}},mounted(){},beforeDestroy(){},methods:{setOscilloscopeTiming(e){let t=1/m.Di(e)*1e3;this.$refs["oscilloscope"].setTiming(t)}},computed:{toolsHost(){return{background:this.colors.green.light}}}};const _t=(0,l.Z)(kt,[["render",ot]]);var Dt=_t;function Mt(e,t,s,o,n,a){const r=(0,i.up)("VolEnvelope"),l=(0,i.up)("Envelope"),h=(0,i.up)("Lfo"),c=(0,i.up)("ModSelector");return(0,i.wg)(),(0,i.iD)("div",{class:"modHost",style:(0,f.j5)(a.modHost)},[(0,i.Wm)(r,{ref:"volEnvelope"},null,512),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.envList,(e=>((0,i.wg)(),(0,i.j4)(l,{key:e.id,id:e.id,ref_for:!0,ref:"envelopes",onIsDraggableUpdate:a.handleDraggableUpdate},null,8,["id","onIsDraggableUpdate"])))),128)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.lfoList,(e=>((0,i.wg)(),(0,i.j4)(h,{key:e.id,id:e.id,ref_for:!0,ref:"lfos"},null,8,["id"])))),128)),(0,i.Wm)(c,{onSelection:a.changeSelection,ref:"modSelector"},null,8,["onSelection"])],4)}const Ct=e=>((0,i.dD)("data-v-24c79e62"),e=e(),(0,i.Cn)(),e),xt=Ct((()=>(0,i._)("div",null,null,-1)));function It(e,t,s,o,n,a){const r=(0,i.up)("EnvelopeVisualizer"),l=(0,i.up)("Knobs");return(0,i.wg)(),(0,i.iD)("div",{ref:"container",class:"container hidden",style:(0,f.j5)(this.container)},[(0,i._)("div",{class:"border",style:(0,f.j5)(this.border)},[(0,i.Wm)(r,{ref:"visualizer",is_volume:!1,onParamRefresh:a.handleRefresh},null,8,["onParamRefresh"]),(0,i.Wm)(l,{ref:"knobs",type:"envelope",id:this.id,parameters:this.parameters,onIsDraggableUpdate:a.handleDraggableUpdate},null,8,["id","parameters","onIsDraggableUpdate"]),xt],4)],4)}s(5361);const Lt=e=>((0,i.dD)("data-v-245c68f8"),e=e(),(0,i.Cn)(),e),Ft={class:"knobs"},Ut=["onMousedown"],jt=Lt((()=>(0,i._)("div",{class:"knob_fader_background"},null,-1)));function Ot(e,t,s,o,n,a){return(0,i.wg)(),(0,i.iD)("div",Ft,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.knobList,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.id,ref_for:!0,ref:e.ref,class:"knob",onMousedown:t=>a.mouseDown(e.id)},[jt,!0===e.isOn?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"knob_fader",style:(0,f.j5)(a.computedFaderStyle(e.id))},null,4)):(0,i.kq)("",!0)],40,Ut)))),128))])}var $t={props:["type","id","parameters"],name:"Knobs",data(){return{knobList:[],freeKnobs:this.nKnobs,isMouseDown:!1,selectedKnobId:""}},mounted(){for(let e=0;e<this.nKnobs;e++)this.knobList.push({id:e,ref:"knob"+e,isOn:!1,amount:0,object:null,target:null});this.isDraggable[this.type][this.id]=!0},methods:{updateParameters(e=this.parameters){for(let t=0;t<this.nKnobs;t++)if(this.knobList[t].isOn){this.knobList[t].object.setModulatorParameters(this.type,this.knobList[t].target,e);break}},knobText(e){return!0===this.knobList[e].isOn?this.knobList[e].amount:"yo"},addLink(e,t,s,o=this.parameters){for(let i=0;i<this.nKnobs;i++)if(!this.knobList[i].isOn){this.knobList[i].color=s,this.knobList[i].isOn=!0,this.knobList[i].amount=.5,this.knobList[i].object=e,this.knobList[i].target=t,this.freeKnobs-=1,console.log("ADDING LINK"),console.log(o),e.setModulatorParameters(this.type,t,o),e.setModulatorAmount(this.type,t,this.knobList[i].amount);break}0===this.freeKnobs&&(this.isDraggable[this.type][this.id]=!1),this.$emit("isDraggableUpdate",this.isDraggable)},removeLink(e,t){this.knobList.forEach((s=>{s.amount=s.amount+.01,s.amount=s.amount-.01,s=(0,X.IU)(s),s.object===e&&s.target===t&&(s.object.setModulatorAmount(this.type,t,0),s.amount=0,s.isOn=!1,s.object=null,s.target=null)})),this.freeKnobs++,this.isDraggable[this.type][this.id]=!0},handleMouseMove(e){this.isMouseDown&&this.knobList[this.selectedKnobId].isOn&&(this.knobList[this.selectedKnobId].amount=this.knobList[this.selectedKnobId].amount-Math.floor(e.movementY)/100,this.knobList[this.selectedKnobId].amount=Math.max(this.knobList[this.selectedKnobId].amount,0),this.knobList[this.selectedKnobId].amount=Math.min(this.knobList[this.selectedKnobId].amount,1),this.knobList[this.selectedKnobId].object.setModulatorAmount(this.type,this.knobList[this.selectedKnobId].target,this.knobList[this.selectedKnobId].amount))},mouseDown(e){this.isMouseDown=!0,this.selectedKnobId=e},computedFaderStyle(e){let t=this.knobList[e].amount;return{backgroundColor:this.knobList[e].color,height:(100*t).toString()+"%"}},handleMouseUp(){this.isMouseDown=!1}},computed:{}};const Pt=(0,l.Z)($t,[["render",Ot],["__scopeId","data-v-245c68f8"]]);var Et=Pt;function Nt(e,t,s,o,n,a){const r=(0,i.up)("EnvelopeVisualizer");return(0,i.wg)(),(0,i.iD)("div",{ref:"container",class:"container hidden",style:(0,f.j5)(this.container)},[(0,i._)("div",{class:"border",style:(0,f.j5)(this.border)},[(0,i.Wm)(r,{ref:"visualizer",is_volume:!0,onParamRefresh:a.handleRefresh},null,8,["onParamRefresh"])],4)],4)}function Tt(e,t,s,o,n,a){return(0,i.wg)(),(0,i.iD)("div",{class:"envelope_container",style:(0,f.j5)(this.envelope_container)},[(0,i._)("div",{class:"envelope",ref:"envelope",style:(0,f.j5)(this.adsr)},[(0,i._)("div",{class:"attack_area",style:(0,f.j5)(a.attack_area),onMousedown:t[0]||(t[0]=e=>a.attack_down())},null,36),(0,i._)("div",{class:"decay_area",style:(0,f.j5)(a.decay_area),onMousedown:t[1]||(t[1]=e=>a.decay_down())},null,36),(0,i._)("div",{class:"sustain_area",style:(0,f.j5)(a.sustain_area),onMousedown:t[2]||(t[2]=e=>a.sustain_down())},null,36),(0,i._)("div",{class:"release_area",style:(0,f.j5)(a.release_area),onMousedown:t[3]||(t[3]=e=>a.release_down())},null,36),(0,i._)("div",{class:"attack_dot",style:(0,f.j5)(a.attack_dot),onMousedown:t[4]||(t[4]=e=>a.attack_down())},null,36),(0,i._)("div",{class:"decay_dot",style:(0,f.j5)(a.decay_dot),onMousedown:t[5]||(t[5]=e=>a.decay_down())},null,36),(0,i._)("div",{class:"release_dot",style:(0,f.j5)(a.release_dot),onMousedown:t[6]||(t[6]=e=>a.release_down())},null,36),(0,i._)("div",{class:"attack",style:(0,f.j5)(this.attack)},[(0,i._)("div",{class:"attack_color",style:(0,f.j5)(this.attack_Color)},null,4)],4),(0,i._)("div",{class:"decay",style:(0,f.j5)(this.decay)},[(0,i._)("div",{class:"decay_head",style:(0,f.j5)(this.decay_head)},null,4),(0,i._)("div",{class:"decay_color",style:(0,f.j5)(this.decay_Color)},null,4)],4),(0,i._)("div",{class:"sustain",style:(0,f.j5)(this.sustain)},[(0,i._)("div",{class:"sustain_head",style:(0,f.j5)(this.sustain_head)},null,4),(0,i._)("div",{class:"sustain_color",style:(0,f.j5)(this.sustain_Color)},null,4)],4),(0,i._)("div",{class:"release",style:(0,f.j5)(this.release)},[(0,i._)("div",{class:"release_color",style:(0,f.j5)(this.release_Color)},null,4)],4),(0,i._)("div",{class:"space",style:(0,f.j5)(this.space)},null,4)],4)],4)}var zt={props:["is_volume"],data(){return{type:"envelope",parameters:{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"linear",sustain:.1,releaseCurve:"linear",release:.1,sustain_lev:.5,duration:4},is_attack_down:!1,is_decay_down:!1,is_sustain_down:!1,is_release_down:!1,test:10}},mounted(){},methods:{handleMouseMove(e){this.isDragging&&(this.tempEvent=e);let t=this.parameters;if(this.is_attack_down&&(e.movementX>0&&(t.attack=Math.min(t.attack+e.movementX/this.$refs.envelope.offsetWidth,1-(t.decay+t.sustain+t.release))),e.movementX<0&&(t.attack=Math.max(t.attack+e.movementX/this.$refs.envelope.offsetWidth,0))),this.is_decay_down&&(e.movementX>0&&(t.decay=Math.min(t.decay+e.movementX/this.$refs.envelope.offsetWidth,1-(t.attack+t.sustain+t.release))),e.movementX<0&&(t.decay=Math.max(t.decay+e.movementX/this.$refs.envelope.offsetWidth,0)),e.movementY>0?t.sustain_lev=Math.max(t.sustain_lev-e.movementY/100,0):e.movementY<0&&(t.sustain_lev=Math.min(t.sustain_lev-e.movementY/100,1))),this.is_sustain_down&&(e.movementX>0&&(t.decay=Math.min(t.decay+e.movementX/this.$refs.envelope.offsetWidth,1-(t.attack+t.sustain+t.release))),e.movementX<0&&(t.decay=Math.max(t.decay+e.movementX/this.$refs.envelope.offsetWidth,0)),e.movementY>0?t.sustain_lev=Math.max(t.sustain_lev-e.movementY/100,0):e.movementY<0&&(t.sustain_lev=Math.min(t.sustain_lev-e.movementY/100,1))),this.is_release_down&&(e.movementX>0&&(t.release=Math.min(t.release+e.movementX/this.$refs.envelope.offsetWidth,1-(t.decay+t.sustain+t.attack))),e.movementX<0&&(t.release=Math.max(t.release+e.movementX/this.$refs.envelope.offsetWidth,0))),this.is_attack_down||this.is_decay_down||this.is_sustain_down||this.is_release_down){let e={attack:this.parameters.attack*this.parameters.duration,decay:this.parameters.decay*this.parameters.duration,sustain:this.parameters.sustain_lev,release:this.parameters.release*this.parameters.duration};this.$emit("paramRefresh",e)}},handleMouseUp(){this.is_attack_down=!1,this.is_decay_down=!1,this.is_sustain_down=!1,this.is_release_down=!1},attack_down(){this.is_attack_down||(this.is_attack_down=!0)},decay_down(){this.is_decay_down||(this.is_decay_down=!0)},sustain_down(){this.is_sustain_down||(this.is_sustain_down=!0)},release_down(){this.is_release_down||(this.is_release_down=!0)}},computed:{envelope_container(){let e="";return e=this.$props["is_volume"]?this.colors.pink.medium:this.colors.azure.medium,{background:e}},adsr(){let e="";return e=this.$props["is_volume"]?"#f8e7e6":"#ceeae7",{display:"grid",opacity:"100%",background:e,gridTemplateColumns:100*this.parameters.attack+"% "+Math.ceil(100*this.parameters.decay)+"% "+Math.ceil(100*this.parameters.sustain)+"% "+Math.ceil(100*this.parameters.release)+"% 10% "}},attack(){return{height:"100%",width:"100%",clipPath:"polygon(0% 100%, 100% 0%, 100% 100%)"}},decay(){return{height:"100%"}},sustain(){return{display:"grid",gridTemplateRows:100*(1-this.parameters.sustain_lev)+"% "+100*this.parameters.sustain_lev+"%",height:"100%"}},release(){return{height:"100%",clipPath:"polygon(0% "+100*(1-this.parameters.sustain_lev)+"%, 0% 100%, 100% 100%)"}},attack_Color(){let e="";return e=this.$props["is_volume"]?this.colors.pink.dark:this.colors.azure.dark,{height:"100%",background:e}},decay_Color(){let e="";return e=this.$props["is_volume"]?this.colors.pink.medium:this.colors.azure.medium,{position:"relative",height:"100%",background:e,top:100*(this.parameters.sustain_lev-1)+"%"}},sustain_Color(){let e="";return e=this.$props["is_volume"]?this.colors.pink.light:this.colors.azure.light,{zIndex:"1",height:"100%",background:e}},release_Color(){let e="";return e=this.$props["is_volume"]?this.colors.pink.light:this.colors.azure.light,{height:"100%",background:e,opacity:"60%"}},decay_head(){let e="";return e=this.$props["is_volume"]?"#f8e7e6":"#ceeae7",{position:"relative",zIndex:"3",background:e,opacity:"100%",top:"-1%",clipPath:"polygon(0% 0%, 100% 100%, 100% 0%)",height:100*(1-this.parameters.sustain_lev)+"%",width:"102%"}},sustain_head(){return{background:"transparent"}},attack_dot(){let e="",t="";return this.$props["is_volume"]?(e=this.colors.pink.dark,t=this.colors.pink.glow):(e=this.colors.azure.dark,t=this.colors.azure.glow),{border:".1vw solid "+t,background:e,aspectRatio:"1/1",height:"7%",position:"absolute",zIndex:"4",borderRadius:"50%",left:100*this.parameters.attack-1+"%",top:"-2%"}},decay_dot(){let e="",t="";return this.$props["is_volume"]?(e=this.colors.pink.medium,t=this.colors.pink.dark):(e=this.colors.azure.medium,t=this.colors.azure.dark),{border:".1vw solid "+t,background:e,aspectRatio:"1/1",height:"7%",position:"absolute",zIndex:"5",borderRadius:"50%",left:100*(this.parameters.decay+this.parameters.attack)-.9+"%",top:100*(1-this.parameters.sustain_lev)-5+"%"}},release_dot(){let e="",t="";return this.$props["is_volume"]?(e=this.colors.pink.glow,t=this.colors.pink.dark):(e=this.colors.azure.glow,t=this.colors.azure.dark),{border:".1vw solid "+t,opacity:"60%",background:e,aspectRatio:"1/1",height:"7%",position:"absolute",zIndex:"2",borderRadius:"50%",left:100*(this.parameters.attack+this.parameters.decay+this.parameters.sustain+this.parameters.release)-1+"%",top:"95%"}},space(){return{background:"transparent"}},attack_area(){return{background:"transparent",aspectRatio:"1/1",width:"10%",position:"absolute",zIndex:"4",borderRadius:"50%",left:100*this.parameters.attack-5+"%"}},decay_area(){return{background:"transparent",aspectRatio:"1/1",width:"10%",position:"absolute",zIndex:"4",borderRadius:"50%",left:100*(this.parameters.decay+this.parameters.attack)-5+"%",top:100*(1-this.parameters.sustain_lev)-20+"%"}},sustain_area(){return{background:"transparent",aspectRatio:"16/9",width:"10%",position:"absolute",zIndex:"4",borderRadius:"50%",left:100*(this.parameters.attack+this.parameters.decay+this.parameters.sustain)-10+"%",top:100*(1-this.parameters.sustain_lev)-12+"%"}},release_area(){return{background:"transparent",aspectRatio:"1/1",width:"7%",position:"absolute",zIndex:"4",borderRadius:"50%",left:100*(this.parameters.attack+this.parameters.decay+this.parameters.sustain+this.parameters.release)-5+"%",top:"80%"}}}};const Rt=(0,l.Z)(zt,[["render",Tt],["__scopeId","data-v-2cbd9afd"]]);var St=Rt,Ht={props:["id"],components:{EnvelopeVisualizer:St},data(){return{tempEvent:null,type:"envelope",parameters:{},knobList:[],is_attack_down:!1,is_decay_down:!1,is_sustain_down:!1,is_release_down:!1}},mounted(){this.parameters={attack:.1,attackCurve:"linear",decay:.5,decayCurve:"linear",sustain:.5,releaseCurve:"linear",release:1,scale:1};for(let e=0;e<9;e++)this.knobList.push({id:e,ref:"knob"+e})},methods:{handleRefresh(e){this.parameters=e,this.synths.list.forEach((e=>{e.setModulatorParameters("envelope","vol",this.parameters)}))},handleNewOsc(){this.synths.list.forEach((e=>{e.setModulatorParameters("envelope","vol",this.parameters)}))},unHide(){this.$refs.container.classList.remove("hidden")},hide(){this.$refs.container.classList.add("hidden")},handleMouseMove(e){this.$refs.visualizer.handleMouseMove(e)},handleMouseUp(e){this.$refs.visualizer.handleMouseUp(e)}},computed:{border(){return{background:"#f8e7e6",opacity:"100%"}},container(){return{background:this.colors.pink.medium}}}};const qt=(0,l.Z)(Ht,[["render",Nt],["__scopeId","data-v-480d7e20"]]);var At=qt;const Kt={class:"lfo_controls_column"},Vt={key:0,class:"lfo_waveform_btn_icon",src:C,alt:"",draggable:"false"},Gt={key:1,class:"lfo_waveform_btn_icon",src:x,alt:"",draggable:"false"},Wt={key:2,class:"lfo_waveform_btn_icon",src:L,alt:"",draggable:"false"},Xt={key:3,class:"lfo_waveform_btn_icon",src:I,alt:"",draggable:"false"};function Yt(e,t,s,o,n,a){const r=(0,i.up)("LfoVisualizer"),l=(0,i.up)("Knobs");return(0,i.wg)(),(0,i.iD)("div",{ref:"container",class:"container hidden",style:(0,f.j5)(this.container)},[(0,i._)("div",{class:"border",style:(0,f.j5)(this.border)},[(0,i._)("div",{class:"lfo_elems_row",style:(0,f.j5)(this.lfo_elems_row)},[(0,i.Wm)(r,{ref:"visualizer",freq:this.freq,depth:this.depth,wave:this.waveform},null,8,["freq","depth","wave"]),(0,i._)("div",Kt,[(0,i._)("div",{class:"lfoFaderBase freqFader",style:(0,f.j5)(this.lfoFaderBase),onMousedown:t[0]||(t[0]=e=>n.isFreqFaderDown=!0)},[(0,i._)("div",{class:"lfoFreqFaderLevel",style:(0,f.j5)(this.lfoFreqFaderLevel)},null,4)],36),(0,i._)("div",{class:"lfo_waveform-btn-selector",style:(0,f.j5)(a.lfo_waveform_btn_selector),onClick:t[1]||(t[1]=(...e)=>a.nextWaveType&&a.nextWaveType(...e))},["sine"===this.waveform?((0,i.wg)(),(0,i.iD)("img",Vt)):(0,i.kq)("",!0),"triangle"===this.waveform?((0,i.wg)(),(0,i.iD)("img",Gt)):(0,i.kq)("",!0),"square"===this.waveform?((0,i.wg)(),(0,i.iD)("img",Wt)):(0,i.kq)("",!0),"sawtooth"===this.waveform?((0,i.wg)(),(0,i.iD)("img",Xt)):(0,i.kq)("",!0)],4)])],4),(0,i.Wm)(l,{ref:"knobs",type:"lfo",id:this.id,parameters:this.parameters},null,8,["id","parameters"])],4)],4)}const Bt={class:"lfoOscilloscope"};function Zt(e,t,s,o,n,a){return(0,i.wg)(),(0,i.iD)("div",Bt,[(0,i._)("canvas",{ref:"canvas",class:"lfoOscilloscopeCanvas",style:(0,f.j5)(this.oscilloscopeCanvas)},null,4)])}const Jt=50,Qt=new Array(Jt).fill(0),es=new Array(Jt).fill(0),ts=new Array(Jt).fill(0),ss=new Array(Jt).fill(0);var os={components:{},props:["freq","depth","wave"],data(){return{timing:10,intervalId:"",waveform:this.wave}},mounted(){console.log("mounted LfoVisual"),this.timing=1e3/(Jt*this.$props.freq);for(let e=0;e<Jt;e++)Qt[e]=Math.sin(2*Math.PI/Jt*e)*this.$props.depth,es[e]=this.$props.depth-2*Math.abs(2*(e-Jt/2)/Jt)*this.$props.depth,ts[e]=e>=Jt/2?this.$props.depth:-this.$props.depth,ss[e]=this.depth*(2*e/Jt-1);switch(this.waveform){case"sine":this.oscilloscopeData=Qt;break;case"triangle":this.oscilloscopeData=es;break;case"square":this.oscilloscopeData=ts;break;case"sawtooth":this.oscilloscopeData=ss;break;default:console.log("ERROR - waveform not recognised")}this.canvas=this.$refs.canvas,this.canvas.width=4*this.canvas.offsetWidth,this.canvas.height=4*this.canvas.offsetHeight,this.ctx=this.canvas.getContext("2d")},methods:{updateParams({freq:e=this.$props.freq,depth:t=this.$props.depth,waveform:s=this.waveform}){switch(this.waveform=s,console.log("this.wave: "+s),this.timing=1e3/(Jt*this.$props.freq),this.waveform){case"sine":this.oscilloscopeData=Qt;break;case"triangle":this.oscilloscopeData=es;break;case"square":this.oscilloscopeData=ts;break;case"sawtooth":this.oscilloscopeData=ss;break;default:console.log("ERROR - waveform not recognised")}this.intervalId&&clearInterval(this.intervalId),this.stopOscilloscope(),console.log("end - this.wave: "+s),(0,i.Y3)((()=>{this.startOscilloscope()}))},startOscilloscope(){this.canvas.width=4*this.canvas.offsetWidth,this.canvas.height=4*this.canvas.offsetHeight,console.log("start - this.waveform: "+this.waveform),this.intervalId=setInterval((()=>{let e=this.oscilloscopeData.shift();this.oscilloscopeData.push(e),this.draw(this.oscilloscopeData)}),this.timing)},stopOscilloscope(){this.intervalId&&clearInterval(this.intervalId)},draw(e){let t,s,o;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.beginPath(),o=this.canvas.height/2*(1-e[0]).toFixed(3);for(let i=1;i<e.length;i++)s=o,t=i*(this.canvas.width/e.length).toFixed(3),o=this.canvas.height/2*(1-e[i]).toFixed(3),this.ctx.moveTo(t,s),this.ctx.lineTo(t+this.canvas.width/e.length,o);this.ctx.stroke(),this.ctx.moveTo(0,0)},beforeDestroy(){this.oscilloscope&&(this.oscilloscope.disconnect(),this.oscilloscope.dispose())}},computed:{oscilloscopeCanvas(){return{background:this.colors.purple.glow}}}};const is=(0,l.Z)(os,[["render",Zt]]);var ns=is;const as=["sine","triangle","square","sawtooth"];var rs={components:{LfoVisualizer:ns,Knobs:Et},props:["id"],data(){return{freq:10,depth:.8,isDepthFaderDown:!1,isFreqFaderDown:!1,waveform:as[0],waveformId:0,parameters:{}}},mounted(){this.parameters={frequency:this.freq,waveform:this.waveform}},computed:{lfoDepthFaderLevel(){return{top:(85*(1-this.depth)).toString()+"%"}},lfo_elems_row(){return{background:this.colors.purple.medium}},lfoFaderBase(){return{background:this.colors.purple.glow}},lfoFreqFaderLevel(){return{top:((20-this.freq)/20*85).toString()+"%",background:this.colors.purple.light,borderColor:this.colors.purple.dark}},lfo_waveform_btn_selector(){return{borderColor:this.colors.purple.dark,background:this.colors.purple.light,color:this.colors.gray.dark}},container(){return{background:this.colors.purple.glow}},border(){return{background:this.colors.purple.glow}}},methods:{setParams({freq:e=this.freq,depth:t=this.depth,waveform:s=this.waveform}){this.freq=e<=20?e:20,"number"===typeof s?(this.waveformId=s,0===this.waveformId||1===this.waveformId?this.waveform=as[this.waveformId]:console.log("ERROR: Called Non existing lfo wave type Id")):"string"===typeof s&&(this.waveform=s,as.forEach(((e,t)=>{e===this.waveform&&(this.waveformId=t)}))),this.parameters.waveform=this.waveform,this.depth=t,this.$refs.visualizer.updateParams({freq:this.freq,depth:this.depth}),this.$refs.knobs.updateParameters(this.parameters)},nextWaveType(){this.waveformId++,this.waveformId>as.length-1&&(this.waveformId=0),this.waveform=as[this.waveformId],this.parameters.waveform=this.waveform,console.log("CHANGING WAVE TYPE TO: "+this.waveform),this.$refs.knobs.updateParameters(this.parameters),this.$refs.visualizer.updateParams({waveform:this.waveform,frequency:this.freq})},startOscilloscope(){console.log("start LFO graphics"),this.$refs.visualizer.startOscilloscope()},stopOscilloscope(){console.log("stop LFO graphics"),this.$refs.visualizer.stopOscilloscope()},resetOscilloscope(){this.$refs.visualizer.stopOscilloscope(),this.$refs.visualizer.startOscilloscope()},depthFaderSelected(){console.log("depthFaderSelected"),this.isDepthFaderDown=!0},freqFaderSelected(){console.log("freqFaderSelected"),this.isFreqFaderDown=!0},handleMouseMove(e){this.$refs.knobs.handleMouseMove(e),this.isDepthFaderDown&&(e.movementY<0?(this.depth=this.depth-e.movementY/100,console.log("moving up")):(this.depth=this.depth-e.movementY/100,console.log("moving down")),this.depth=Math.max(this.depth,0),this.depth=Math.min(this.depth,1),console.log("lfo depth: "+this.depth),this.$refs.visualizer.updateParams({depth:this.depth})),this.isFreqFaderDown&&(e.movementY<0?(this.freq=this.freq-e.movementY/100*20,console.log("moving up")):this.freq=this.freq-e.movementY/100*20,this.freq=Math.max(this.freq,1),this.freq=Math.min(this.freq,20),console.log("lfo freq: "+this.freq),this.parameters.frequency=this.freq,this.$refs.visualizer.updateParams({freq:this.freq}),this.$refs.knobs.updateParameters(this.parameters))},handleMouseUp(){this.isFreqFaderDown&&(this.isFreqFaderDown=!1),this.isDepthFaderDown&&(this.isDepthFaderDown=!1),this.$refs.knobs.handleMouseUp()},unHide(){this.$refs.container.classList.remove("hidden"),this.startOscilloscope()},hide(){this.$refs.container.classList.add("hidden")},link(e,t,s){this.$refs.knobs.addLink(e,t,s)},unLink(e,t){this.$refs.knobs.removeLink(e,t)}}};const ls=(0,l.Z)(rs,[["render",Yt],["__scopeId","data-v-54138dca"]]);var hs=ls,cs=s.p+"img/ADSR.0372dc1c.svg",ds=s.p+"img/LFO.27316b42.svg";const us=e=>((0,i.dD)("data-v-0ef4a2a4"),e=e(),(0,i.Cn)(),e),ps=us((()=>(0,i._)("img",{src:cs,alt:"",draggable:"false"},null,-1))),ms=[ps],fs=["onClick"],vs=us((()=>(0,i._)("img",{src:cs,alt:"",draggable:"false"},null,-1))),gs=[vs],ys=["draggable","onDragstart"],ws=["onClick"],bs=us((()=>(0,i._)("img",{src:ds,alt:"",draggable:"false"},null,-1))),ks=[bs],_s=["draggable","onDragstart"];function Ds(e,t,s,o,n,a){return(0,i.wg)(),(0,i.iD)("div",{class:"buttonList",style:(0,f.j5)(this.buttonList)},[(0,i._)("div",{class:"identifierVol",style:(0,f.j5)(a.buttonColor("mainEnv")),onClick:t[0]||(t[0]=e=>a.handleClick(null,"volEnvelope"))},ms,4),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.buttonListEnv,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.id,class:"button",style:(0,f.j5)(a.buttonColor("envelope"))},[(0,i._)("div",{style:(0,f.j5)(a.textId)},(0,f.zw)(e.id),5),(0,i._)("div",{class:"identifier",onClick:t=>a.handleClick(e.id,e.type)},gs,8,fs),(0,i._)("div",{class:"draggableArea",draggable:a.draggability("envelope",e.id),onDragstart:t=>a.startDrag(t,e.id,e.type)},"ϟ ",40,ys)],4)))),128)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.buttonListLfo,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e.id,class:"button",style:(0,f.j5)(a.buttonColor("lfo"))},[(0,i._)("div",{style:(0,f.j5)(a.textId)},(0,f.zw)(e.id),5),(0,i._)("div",{class:"identifier",onClick:t=>a.handleClick(e.id,e.type)},ks,8,ws),(0,i._)("div",{class:"draggableArea",draggable:a.draggability("lfo",e.id),onDragstart:t=>a.startDrag(t,e.id,e.type)},"ϟ ",40,_s)],4)))),128))],4)}var Ms={inject:["dropFeedback"],props:[],data(){return{color:{mainEnv:this.colors.pink.glow,envelope:this.colors.azure.glow,lfo:this.colors.purple.glow},type:"volEnvelope",isDraggable:this.isDraggable,buttonListEnv:[],buttonListLfo:[]}},mounted(){for(let e=1;e<this.nEnvelopes+1;e++)this.buttonListEnv.push({id:e,ref:"button"+e,type:"envelope"});for(let e=1;e<this.nLfo+1;e++)this.buttonListLfo.push({id:e,ref:"button"+e,type:"lfo"})},computed:{textId(){return{fontWeight:"bold",opacity:"80%",position:"absolute",fontSize:".8vw"}},buttonList(){switch(this.type){case"volEnvelope":return{backgroundColor:this.colors.pink.medium};case"envelope":return{backgroundColor:this.colors.azure.medium};case"lfo":return{backgroundColor:this.colors.purple.glow}}}},methods:{draggability(e,t){return this.isDraggable[e][t]},isDraggableUpdate(e){this.isDraggable=e},buttonColor(e){return{backgroundColor:this.color[e]}},startDrag(e,t,s){e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move";let o={type:s,id:t,color:this.color[s]};e.dataTransfer.setData("data",JSON.stringify(o))},handleClick(e,t){this.type=t,"volEnvelope"===t?this.$emit("selection",t,null):this.$emit("selection",e,t)}}};const Cs=(0,l.Z)(Ms,[["render",Ds],["__scopeId","data-v-0ef4a2a4"]]);var xs=Cs,Is={components:{EnvelopeVisualizer:St,Knobs:Et},props:["id"],data(){return{parameters:{attack:.025,attackCurve:"linear",decay:.25,decayCurve:"linear",releaseCurve:"linear",release:.25,sustain:.5}}},methods:{handleRefresh(e){this.parameters=e,this.$refs.knobs.updateParameters(this.parameters)},link(e,t,s){this.$refs.knobs.addLink(e,t,s)},unLink(e,t){this.$refs.knobs.removeLink(e,t)},handleDraggableUpdate(e){this.$emit("isDraggableUpdate",e)},unHide(){this.$refs.container.classList.remove("hidden")},hide(){this.$refs.container.classList.add("hidden")},handleMouseMove(e){this.$refs.visualizer.handleMouseMove(e),this.$refs.knobs.handleMouseMove(e)},handleMouseUp(e){this.$refs.visualizer.handleMouseUp(e),this.$refs.knobs.handleMouseUp(e)}},computed:{border(){return{background:"#ceeae7"}},container(){return{background:this.colors.azure.medium}}}};const Ls=(0,l.Z)(Is,[["render",It],["__scopeId","data-v-24c79e62"]]);var Fs=Ls,Us={components:{VolEnvelope:At,Envelope:Fs,Lfo:hs,ModSelector:xs},data(){return{name:"modHost",selection:"volEnvelope",selectionType:null,envList:[],lfoList:[]}},created(){for(let e=1;e<this.nEnvelopes+1;e++)this.envList.push({id:e,ref:e});for(let e=1;e<this.nLfo+1;e++)this.lfoList.push({id:e,ref:e})},mounted(){this.$refs.volEnvelope.unHide(),console.log(this.$refs.volEnvelope),document.addEventListener("link",this.handleLink),document.addEventListener("unLink",this.handleUnlink)},computed:{modHost(){return{background:this.colors.gray.glow}}},methods:{handleDraggableUpdate(e){this.$refs.modSelector.isDraggableUpdate(e)},handleNewOsc(){this.$refs.volEnvelope.handleNewOsc()},handleMouseUp(e){"volEnvelope"===this.selection?this.$refs.volEnvelope.handleMouseUp(e):("envelope"===this.selectionType&&(0,X.IU)((0,X.IU)(this.$refs.envelopes)[this.selection-1]).handleMouseUp(e),"lfo"===this.selectionType&&(0,X.IU)((0,X.IU)(this.$refs.lfos)[this.selection-1]).handleMouseUp(e))},handleMouseMove(e){"volEnvelope"===this.selection?this.$refs.volEnvelope.handleMouseMove(e):("envelope"===this.selectionType&&(0,X.IU)((0,X.IU)(this.$refs.envelopes)[this.selection-1]).handleMouseMove(e),"lfo"===this.selectionType&&(0,X.IU)((0,X.IU)(this.$refs.lfos)[this.selection-1]).handleMouseMove(e))},changeSelection(e,t){console.log("selected "+e),console.log(this.$refs),"volEnvelope"===this.selection?this.$refs.volEnvelope.hide():("envelope"===this.selectionType&&(0,X.IU)((0,X.IU)(this.$refs.envelopes)[this.selection-1]).hide(),"lfo"===this.selectionType&&((0,X.IU)((0,X.IU)(this.$refs.lfos)[this.selection-1]).hide(),(0,X.IU)((0,X.IU)(this.$refs.lfos)[this.selection-1]).stopOscilloscope())),"volEnvelope"===e?this.$refs.volEnvelope.unHide():("envelope"===t&&(0,X.IU)((0,X.IU)(this.$refs.envelopes)[e-1]).unHide(),"lfo"===t&&(0,X.IU)((0,X.IU)(this.$refs.lfos)[e-1]).unHide()),this.selection=e,this.selectionType=t},handleLink(e){console.log("link");let t=e.detail;this.$refs[t.modulator.type+"s"][t.modulator.id-1].link(t.object,t.target,t.color)},handleUnlink(e){console.log("unLink");let t=e.detail;this.$refs[t.modulator.type+"s"][t.modulator.id-1].unLink(t.object,t.target)}}};const js=(0,l.Z)(Us,[["render",Mt],["__scopeId","data-v-1227fc83"]]);var Os=js;const $s={class:"container"},Ps={class:"container"},Es={class:"container"};function Ns(e,t,s,o,n,a){const r=(0,i.up)("Octave"),l=(0,i.up)("MIDIKeyboard");return(0,i.wg)(),(0,i.iD)("div",{class:"span",onMouseleave:t[0]||(t[0]=(...t)=>e.handleMouseLeave&&e.handleMouseLeave(...t))},[(0,i._)("div",$s,[(0,i.Wm)(r,{ref:"oct1",octaveNumber:1,onVirtualKeyDown:a.handleNoteDown,onVirtualKeyUp:a.handleNoteUp},null,8,["onVirtualKeyDown","onVirtualKeyUp"])]),(0,i._)("div",Ps,[(0,i.Wm)(r,{ref:"oct2",octaveNumber:2,onVirtualKeyDown:a.handleNoteDown,onVirtualKeyUp:a.handleNoteUp},null,8,["onVirtualKeyDown","onVirtualKeyUp"])]),(0,i._)("div",Es,[(0,i.Wm)(r,{ref:"oct3",octaveNumber:3,onVirtualKeyDown:a.handleNoteDown,onVirtualKeyUp:a.handleNoteUp},null,8,["onVirtualKeyDown","onVirtualKeyUp"])]),(0,i.Wm)(l,{onMIDIDown:a.handleMIDIDown,onMIDIUp:a.handleMIDIUp},null,8,["onMIDIDown","onMIDIUp"])],32)}function Ts(e,t,s,o,i,n){return null}var zs={data(){return{midiAccess:null,midiInput:null,notes:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],lowestOctave:-2}},mounted(){navigator.requestMIDIAccess().then((e=>{e.inputs.size>0&&(this.midiAccess=e,this.midiInput=e.inputs.values().next().value,this.midiInput.addEventListener("midimessage",this.handleMidiMessage))}))},methods:{handleMidiMessage(e){let[t,s,o]=e.data,i=this.notes[s%12],n=this.lowestOctave+parseInt(s/12,10);144==t?this.$emit("MIDIDown",i,n,o):128==t&&this.$emit("MIDIUp",i,n)}}};const Rs=(0,l.Z)(zs,[["render",Ts]]);var Ss=Rs;const Hs={class:"woctave"},qs={class:"boctave"};function As(e,t,s,o,n,a){return(0,i.wg)(),(0,i.iD)("div",{class:"octave",onMousedown:t[12]||(t[12]=(...e)=>a.handleMouseDown&&a.handleMouseDown(...e)),onMouseup:t[13]||(t[13]=(...e)=>a.handleMouseUp&&a.handleMouseUp(...e)),onMouseover:t[14]||(t[14]=(...e)=>a.handleMouseOver&&a.handleMouseOver(...e))},[(0,i._)("div",Hs,[(0,i._)("div",{id:"C",ref:"C",onMouseleave:t[0]||(t[0]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"wkey wUnpressed"},null,544),(0,i._)("div",{id:"D",ref:"D",onMouseleave:t[1]||(t[1]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"wkey wUnpressed"},null,544),(0,i._)("div",{id:"E",ref:"E",onMouseleave:t[2]||(t[2]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"wkey wUnpressed"},null,544),(0,i._)("div",{id:"F",ref:"F",onMouseleave:t[3]||(t[3]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"wkey wUnpressed"},null,544),(0,i._)("div",{id:"G",ref:"G",onMouseleave:t[4]||(t[4]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"wkey wUnpressed"},null,544),(0,i._)("div",{id:"A",ref:"A",onMouseleave:t[5]||(t[5]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"wkey wUnpressed"},null,544),(0,i._)("div",{id:"B",ref:"B",onMouseleave:t[6]||(t[6]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"wkey wUnpressed"},null,544)]),(0,i._)("div",qs,[(0,i._)("div",{id:"C#",ref:"Cs",onMouseleave:t[7]||(t[7]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"bkey bUnpressed",style:{"grid-column":"3 / 5"}},null,544),(0,i._)("div",{id:"D#",ref:"Ds",onMouseleave:t[8]||(t[8]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"bkey bUnpressed",style:{"grid-column":"6 / 8"}},null,544),(0,i._)("div",{id:"F#",ref:"Fs",onMouseleave:t[9]||(t[9]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"bkey bUnpressed",style:{"grid-column":"12 / 14"}},null,544),(0,i._)("div",{id:"G#",ref:"Gs",onMouseleave:t[10]||(t[10]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"bkey bUnpressed",style:{"grid-column":"15 / 17"}},null,544),(0,i._)("div",{id:"A#",ref:"As",onMouseleave:t[11]||(t[11]=(...e)=>a.handleMouseLeave&&a.handleMouseLeave(...e)),class:"bkey bUnpressed",style:{"grid-column":"18 / 20"}},null,544)])],32)}var Ks={name:"Octave",props:{octaveNumber:Number},data(){return{}},methods:{handleMouseLeave(e){this.$parent.mouseDown&&this.notifyUp(e.currentTarget)},handleMouseUp(e){this.$parent.mouseDown=!1,this.notifyUp(e.target)},handleMouseDown(e){this.$parent.mouseDown=!0,this.notifyDown(e.target)},handleMouseOver(e){this.$parent.mouseDown&&this.notifyDown(e.target)},notifyDown(e){this.$emit("virtualKeyDown",e.id,this.octaveNumber),this.switchColorPress(e.id)},switchColorPress(e){e.includes("#")&&(e=e.replace("#","s"));let t=this.$refs[e];t.classList.contains("wkey")?(t.classList.remove("wUnpressed"),t.classList.add("pressed")):(t.classList.remove("bUnpressed"),t.classList.add("pressed"))},notifyUp(e){this.$emit("virtualKeyUp",e.id,this.octaveNumber),this.switchColorRelease(e.id)},switchColorRelease(e){if("all"===e)for(const t of Object.values(this.$refs))t.classList.contains("wkey")?(t.classList.add("wUnpressed"),t.classList.remove("pressed")):(t.classList.add("bUnpressed"),t.classList.remove("pressed"));else{e.includes("#")&&(e=e.replace("#","s"));let t=this.$refs[e];t.classList.contains("wkey")?(t.classList.add("wUnpressed"),t.classList.remove("pressed")):(t.classList.add("bUnpressed"),t.classList.remove("pressed"))}}}};const Vs=(0,l.Z)(Ks,[["render",As]]);var Gs=Vs,Ws={name:"PianoKeyboard",components:{Octave:Gs,MIDIKeyboard:Ss},data(){return{ocTranspose:1,keysDown:{},keys:"awsedftgyhujkolpòà",notes:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],keyboardTranspose:0,mouseDown:!1}},mounted(){window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)},beforeDestroy(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)},methods:{handleMouseUp(){this.mouseDown=!1},handleKeyDown(e){if(!this.keysDown[e.key]&&this.keys.includes(e.key)){let t=this.notes[this.keys.indexOf(e.key)%12],s=parseInt(this.keys.indexOf(e.key)/12,10);this.handleNoteDown(t,2+s+this.keyboardTranspose,100),this.keysDown[e.key]=!0,2+s+this.keyboardTranspose>0&&2+s+this.keyboardTranspose<4&&this.$refs["oct"+(2+s+this.keyboardTranspose)].switchColorPress(t)}this.keysDown[e.key]||"z"!=e.key||(this.keyboardTranspose=this.keyboardTranspose-1),this.keysDown[e.key]||"x"!=e.key||(this.keyboardTranspose=this.keyboardTranspose+1)},handleKeyUp(e){if(this.keysDown[e.key]){let t=this.notes[this.keys.indexOf(e.key)%12],s=parseInt(this.keys.indexOf(e.key)/12,10);this.handleNoteUp(t,2+s+this.keyboardTranspose),this.keysDown[e.key]=!1,2+s+this.keyboardTranspose>0&&2+s+this.keyboardTranspose<4&&this.$refs["oct"+(2+s+this.keyboardTranspose)].switchColorRelease(t)}},handleMIDIDown(e,t,s){t>0&&t<4&&this.$refs["oct"+t].switchColorPress(e),this.synths.list.forEach((o=>{o.playNote(e+t,s)}));for(let o in this.filterChains)for(let e in this.filterChains[o])this.filterChains[o][e].playNote();this.$emit("noteDown",e)},handleMIDIUp(e,t){t>0&&t<4&&this.$refs["oct"+t].switchColorRelease(e),this.synths.list.forEach((s=>{s.stopNote(e+t)}));for(let s in this.filterChains)for(let e in this.filterChains[s])this.filterChains[s][e].stopNote()},handleNoteDown(e,t,s=100){let o=parseInt(t)+this.ocTranspose;this.synths.list.forEach((t=>{t.playNote(e+o,s)}));for(let i in this.filterChains)for(let e in this.filterChains[i])this.filterChains[i][e].playNote();this.$emit("noteDown",e+o)},handleNoteUp(e,t){let s=parseInt(t)+this.ocTranspose;this.synths.list.forEach((t=>{t.stopNote(e+s)}));for(let o in this.filterChains)for(let e in this.filterChains[o])this.filterChains[o][e].stopNote()}}};const Xs=(0,l.Z)(Ws,[["render",Ns],["__scopeId","data-v-083b757d"]]);var Ys=Xs,Bs={name:"mainHost",components:{LFO:hs,OscHost:ie,FilterHost:Ue,FxHost:st,ToolHost:Dt,ModHost:Os,PianoKeyboard:Ys},data(){return{draggedInfo:null}},mounted(){m.J7.start("+0.1")},methods:{initOscConnections(){this.$refs.oscHost.initConnections()},initFilterConnections(){},handleNewOsc(){this.$refs.modHost.handleNewOsc()},handleMouseUp(e){this.$refs.pianoKeyboard.handleMouseUp(),this.$refs.modHost.handleMouseUp(e),this.$refs.fxHost.handleMouseUp(e),this.draggedInfo&&setTimeout((()=>this.deleteDraggedInfo("MainHost")),100)},handleMouseMove(e){this.$refs.modHost.handleMouseMove(e),this.$refs.fxHost.handleMouseMove(e)},noteDownHandle(e){this.$refs["toolsHost"].setOscilloscopeTiming(e)},noteUpHandle(e){}}};const Zs=(0,l.Z)(Bs,[["render",p]]);var Js=Zs;const Qs=[{path:"/",name:"synth",component:Js},{path:"/about",name:"about",component:()=>s.e(443).then(s.bind(s,8764))}],eo=(0,d.p7)({history:(0,d.PO)("/"),routes:Qs});var to=eo;const so=(0,o.ri)(c).use(to);so.config.globalProperties.synths={list:[]},so.config.globalProperties.nFilterChains=3,so.config.globalProperties.nFiltersXchain=3,so.config.globalProperties.areFiltersMounted=!1,so.config.globalProperties.nFxChains=3,so.config.globalProperties.nFxXchain=5,so.config.globalProperties.nNodesXfxChain=7,so.config.globalProperties.areFxMounted=!1,so.config.globalProperties.nModulators=6,so.config.globalProperties.nEnvelopes=3,so.config.globalProperties.nLfo=2,so.config.globalProperties.nKnobs=9,so.config.globalProperties.polyphonyVoices=4,so.config.globalProperties.filterChains=Array(so.config.globalProperties.nFilterChains);for(let oo=0;oo<so.config.globalProperties.nFilterChains;oo++)so.config.globalProperties.filterChains[oo]=Array(so.config.globalProperties.nFiltersXchain);so.config.globalProperties.fxChains=Array(so.config.globalProperties.nFxChains);for(let oo=0;oo<so.config.globalProperties.nFxChains;oo++)so.config.globalProperties.fxChains[oo]=Array(so.config.globalProperties.nNodesXfxChain);so.config.globalProperties.colors={green:{light:"#7fe2a6",medium:"#599e74",dark:"#335a42",glow:"#b2eeca"},yellow:{light:"#fee573",medium:"#e5ce68",dark:"#b2a051",glow:"#feefab"},azure:{light:"#8fe1d8",medium:"#81cbc2",dark:"#649e97",glow:"#b1eae4"},purple:{light:"#cdadc4",medium:"#b99cb0",dark:"#a48a9d",glow:"#e1cedc"},pink:{light:"#f3a59a",medium:"#db958b",dark:"#c2847b",glow:"#f9d2cd"},orange:{light:"#ffc16c",medium:"#e6ae61",dark:"#cc9a56",glow:"#ffd498"},gray:{light:"#a8a8a8",medium:"#868686",dark:"#111111",glow:"#f6f6f6"}},so.config.globalProperties.dropFeedback=null,so.provide("dropFeedback",so.config.globalProperties.dropFeedback),so.config.globalProperties.isDraggable={envelope:{},lfo:{}},so.mount("#app")}},t={};function s(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,o,i,n){if(!o){var a=1/0;for(c=0;c<e.length;c++){o=e[c][0],i=e[c][1],n=e[c][2];for(var r=!0,l=0;l<o.length;l++)(!1&n||a>=n)&&Object.keys(s.O).every((function(e){return s.O[e](o[l])}))?o.splice(l--,1):(r=!1,n<a&&(a=n));if(r){e.splice(c--,1);var h=i();void 0!==h&&(t=h)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,i,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,o){return s.f[o](e,t),t}),[]))}}(),function(){s.u=function(e){return"js/about.deef0cfd.js"}}(),function(){s.miniCssF=function(e){return"css/about.c08e986a.css"}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="actam:";s.l=function(o,i,n,a){if(e[o])e[o].push(i);else{var r,l;if(void 0!==n)for(var h=document.getElementsByTagName("script"),c=0;c<h.length;c++){var d=h[c];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+n){r=d;break}}r||(l=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,s.nc&&r.setAttribute("nonce",s.nc),r.setAttribute("data-webpack",t+n),r.src=o),e[o]=[i];var u=function(t,s){r.onerror=r.onload=null,clearTimeout(p);var i=e[o];if(delete e[o],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach((function(e){return e(s)})),t)return t(s)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=u.bind(null,r.onerror),r.onload=u.bind(null,r.onload),l&&document.head.appendChild(r)}}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,s,o,i){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var a=function(s){if(n.onerror=n.onload=null,"load"===s.type)o();else{var a=s&&("load"===s.type?"missing":s.type),r=s&&s.target&&s.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=r,n.parentNode.removeChild(n),i(l)}};return n.onerror=n.onload=a,n.href=t,s?s.parentNode.insertBefore(n,s.nextSibling):document.head.appendChild(n),n},t=function(e,t){for(var s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var i=s[o],n=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(n===e||n===t))return i}var a=document.getElementsByTagName("style");for(o=0;o<a.length;o++){i=a[o],n=i.getAttribute("data-href");if(n===e||n===t)return i}},o=function(o){return new Promise((function(i,n){var a=s.miniCssF(o),r=s.p+a;if(t(a,r))return i();e(o,r,null,i,n)}))},i={143:0};s.f.miniCss=function(e,t){var s={443:1};i[e]?t.push(i[e]):0!==i[e]&&s[e]&&t.push(i[e]=o(e).then((function(){i[e]=0}),(function(t){throw delete i[e],t})))}}}(),function(){var e={143:0};s.f.j=function(t,o){var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)o.push(i[2]);else{var n=new Promise((function(s,o){i=e[t]=[s,o]}));o.push(i[2]=n);var a=s.p+s.u(t),r=new Error,l=function(o){if(s.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var n=o&&("load"===o.type?"missing":o.type),a=o&&o.target&&o.target.src;r.message="Loading chunk "+t+" failed.\n("+n+": "+a+")",r.name="ChunkLoadError",r.type=n,r.request=a,i[1](r)}};s.l(a,l,"chunk-"+t,t)}},s.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,n,a=o[0],r=o[1],l=o[2],h=0;if(a.some((function(t){return 0!==e[t]}))){for(i in r)s.o(r,i)&&(s.m[i]=r[i]);if(l)var c=l(s)}for(t&&t(o);h<a.length;h++)n=a[h],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(c)},o=self["webpackChunkactam"]=self["webpackChunkactam"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[998],(function(){return s(6226)}));o=s.O(o)})();
//# sourceMappingURL=app.8abf3c43.js.map